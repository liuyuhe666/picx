var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(t,a,i)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i,s=(e,s)=>{for(var o in s||(s={}))a.call(s,o)&&l(e,o,s[o]);if(t)for(var o of t(s))i.call(s,o)&&l(e,o,s[o]);return e};import{o,c as n,a as r,v as c,b as d,E as u,d as m,C as g,e as p,f as _,g as h,h as f,i as v,j as b,u as y,k as w,r as x,l as I,w as S,m as k,n as T,p as L,q as E,t as O,s as C,x as A,y as P,z as $,F as D,A as G,B as U,D as R,G as z,H as M,I as N,M as H,J as j,K as V,L as B,N as F,O as X,P as q,Q as W,R as J,S as K,T as Z,U as Y,V as Q,W as ee,X as te,Y as ae,Z as ie,_ as le,$ as se,a0 as oe,a1 as ne,a2 as re,a3 as ce,a4 as de,a5 as ue,a6 as me,a7 as ge,a8 as pe,a9 as _e,aa as he,ab as fe,ac as ve,ad as be,ae as ye,af as we,ag as xe,ah as Ie,ai as Se,aj as ke,ak as Te,al as Le,am as Ee,an as Oe,ao as Ce,ap as Ae,aq as Pe,ar as $e,as as De,at as Ge,au as Ue,av as Re,aw as ze}from"./vendor.10d14369.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const Me={},Ne={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},He=[r("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896a448 448 0 0 1 0-896m-55.808 536.384l-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.27 38.27 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"},null,-1)];var je={name:"ep-circle-check-filled",render:function(e,t){return o(),n("svg",Ne,[...He])}};const Ve={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Be=[r("path",{fill:"currentColor",d:"M715.648 625.152L670.4 579.904l90.496-90.56c75.008-74.944 85.12-186.368 22.656-248.896c-62.528-62.464-173.952-52.352-248.96 22.656L444.16 353.6l-45.248-45.248l90.496-90.496c100.032-99.968 251.968-110.08 339.456-22.656c87.488 87.488 77.312 239.424-22.656 339.456l-90.496 90.496zm-90.496 90.496l-90.496 90.496C434.624 906.112 282.688 916.224 195.2 828.8c-87.488-87.488-77.312-239.424 22.656-339.456l90.496-90.496l45.248 45.248l-90.496 90.56c-75.008 74.944-85.12 186.368-22.656 248.896c62.528 62.464 173.952 52.352 248.96-22.656l90.496-90.496zm0-362.048l45.248 45.248L398.848 670.4L353.6 625.152z"},null,-1)];var Fe={name:"ep-link",render:function(e,t){return o(),n("svg",Ve,[...Be])}};const Xe={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},qe=[r("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"},null,-1)];var We={name:"ep-document",render:function(e,t){return o(),n("svg",Xe,[...qe])}};const Je="picx-images-hosting",Ke="PicX images hosting repository",Ze="master",Ye="Init repo via PicX (https://github.com/XPoet/picx)",Qe=(e,t)=>({type:"dir",dir:e,dirPath:t,childrenDirs:[],imageList:[]});function et(e,t,a){var i;return e?t.length===a?e:et(null==(i=e.childrenDirs)?void 0:i.find((e=>e.dir===t[a])),t,++a):null}const tt=(e,t)=>{if("/"===e)return t;return et(t,e.split("/"),0)},at=(e,t)=>{var a;return"dir"===t?null==(a=e.childrenDirs)?void 0:a.filter((e=>"dir"===e.type)):"image"===t?e.imageList.filter((e=>"image"===e.type)):[]};var it={repo:"仓库",branch:"分支",dir:"目录",tip:"提示",delete:"删除",reset:"重置",confirm:"确定",cancel:"取消",author:"作者",document:"文档",shortcut_key:"快捷键",username:"用户名",email:"邮箱",login:"登录",logout:"退出登录",language:"语言",uploaded:"已上传",upload:"上传",rename:"重命名",copy_link:"复制图片链接",paste_image:"粘贴图片",copy_success_1:"图片链接已自动复制到系统剪贴板",copy_success_2:"图片链接复制成功",copy_fail_1:"复制失败",header:{not_login:"未登录",theme:"主题",announcement:{text_1:"网站公告",text_2:"1、PicX v3.0 进一步简化用户操作，统一使用内置的仓库和分支",text_3:"2、如果你需要继续使用自定义的仓库和分支，请使用",text_4:"不再提示"}},nav:{config:"图床配置",upload:"上传图片",management:"图床管理",settings:"图床设置",toolbox:"工具箱",feedback:"帮助反馈",actions:"快捷操作"},actions:{watermark:"图片水印",compress:"压缩图片",transform:"转换 "},config_page:{input_token:"请输入 GitHub Token ...",one_click_config:"一键配置",loading_1:"正在加载用户信息 ...",loading_4:"正在加载仓库目录数据 ...",loading_5:"正在加载目录信息 ...",loading_6:"正在自动配置 ...",placeholder_4:"请输入新建的目录 ...",placeholder_5:"请选择一个目录 ...",message_1:"GitHub Token 不能为空",message_2:"用户信息获取失败，请确认 Token 是否正确",message_3:"自动创建 GitHub 仓库失败，请稍后再试",message_4:"图床配置成功",message_5:"一键自动配置失败，请重试",message_6:"目录不能为空",message_7:"请输入一个新目录",message_8:"请选择仓库里的一个目录",message_9:"仓库信息获取失败，请稍后重试",dir_mode:"目录模式",create_new_dir:"新建目录",input_new_dir:"手动输入一个新目录",root_dir:"根目录",date_dir:"日期目录",date_dir_tip:"自动创建 yyyyMMdd 格式的日期目录",repo_dir:"仓库目录",select_dir:"选择目录",reload:"重新加载"},settings_page:{img_name:{title:"图片名称设置",md5_switch_name:"MD5",md5_switch_desc:"使用MD5加密图片名称",hash_switch_name:"哈希化",hash_switch_desc:"上传时给图片名称增加哈希值，确保图片名称唯一，强烈建议开启",prefix_switch_name:"添加前缀",prefix_switch_desc:"上传时给图片名称增加前缀，例如：abc-image.jpg，abc- 为前缀",prefix_input_placeholder:"请输入前缀 ..."},img_watermark:{title:"图片水印设置",switch_name:"是否添加水印",switch_desc:"开启后可以自定义水印文字、字体大小、位置、颜色和透明度",text:"水印文字",text_input_placeholder:"请输入水印文字，限制 20 字",size:"水印大小",color:"水印颜色",opacity:"水印透明度",position:"水印位置",position_1:"左上角",position_2:"左下角",position_3:"右上角",position_4:"右下角"},img_compress:{title:"图片压缩设置",switch_name:"是否压缩图片",switch_desc:"开启后上传前会自动压缩图片，有效缩短图片上传和加载时间，强烈建议开启",radio_group_title:"选择图片压缩算法",radio_1:"webP",radio_1_desc:"压缩后图片格式为 webp，压缩率较高，大多数浏览器支持",radio_2:"mozJPEG",radio_2_desc:"压缩后图片格式为 jpg，兼容性最好，所有浏览器支持",radio_3:"avif",radio_3_desc:"压缩后图片格式为 avif，压缩率极高，部分现代浏览器支持"},link_rule:{title:"图片链接规则配置",select_title:"选择图片链接规则",card_title:"配置自定义图片链接规则",card_table_col_title_1:"类型",card_table_col_title_2:"图片链接规则",card_table_col_title_3:"操作",input_name_1:"图片链接类型",input_name_1_rule:"图片链接类型名称不能为空",input_name_2:"图片链接规则",input_name_2_rule:"图片链接规则不能为空",btn_name_1:"添加图片链接规则",error_msg_1:"添加失败，该图片链接规则已存在",error_msg_2:"{action}失败，图片链接规则必须包含 {path}",error_msg_3:"图片链接规则缺少 {rules}，是否确认{action}？",add:"添加",edit:"编辑"},link_format:{title:"图片链接格式设置",switch_name:"自动转换图片链接格式",switch_desc:"上传成功后复制的图片链接自动转换成 {type} 格式",select_title:"选择图片链接格式",delete_tips:"此操作将永久删除图片链接规则"},image_hosting_deploy:{title:"图床部署",one_click_deploy:"一键部署",deploy_to:"部署到 {server}",success:"部署成功",fail:"部署失败",fail2:"部署失败，请稍后再试",deploying:"正在部署到 GitHub Pages，该过程持续 1 分钟左右，请耐心等待 ...",not_deployed:"未部署"},theme:{title:"主题设置",system:"跟随系统",dark:"暗夜",light:"白昼"},cloud_settings:{tip_1:"检测到你的设置数据未保存到云端仓库，是否保存？",tip_2:"检测到你的云端仓库存在设置文件，是否使用？",tip_3:"检测到你的设置数据有变化，是否同步到云端仓库？",tip_4:"本地设置数据和云端仓库设置数据一致",success_msg_1:"保存成功",success_msg_2:"更新成功"}},upload_page:{upload_area_text:"拖拽 / 粘贴 / 点击此处选择图片",message1:"请先完成图床配置",message2:"请选择一个仓库",message3:"目录不能为空",message4:"请选择要上传的图片",message5:"图片上传成功",message6:"图片批量上传成功",message7:"上传失败，请稍后重试",message8:"图片上传成功",fold:"折叠",expand:"展开",add_hash:"哈希化",add_prefix:"添加前缀",uploading:"正在上传 ...",tip_9:"{name} 不是图片格式",tip_10:"{name} 超过 {size} MB，跳过选择",tip_11:"{name} 上传失败"},management_page:{reload:"重新加载",loadingTxt1:"加载中 ...",loadingTxt2:"正在重命名 ...",loadingTxt3:"删除中 ...",property:"属性",delTips:"此操作将会永久删除图片",delTips2:"已选中 {total} 张图片，是否批量删除？",message1:"图片名称不能为空",message2:"图片名无改变",message3:"重命名失败，请重试",message4:"更新成功",message5:"删除成功",message6:"批量删除成功",message7:"删除失败，请稍后重试",imageName:"图片名称",imageSize:"图片大小",selectAll:"全选",deselectAll:"取消全选",unselect:"取消选择",batchCopy:"批量复制图片链接",batchDelete:"批量删除图片",selectTotal:"已选择 {total} 张图片",contextmenu_1:"从当前位置上传新图片",contextmenu_2:"上传图片到 {dir}",contextmenu_3:"根目录",text_1:"请输入新的图片名称",text_2:"立即上传"},toolbox:{tool_1:"图片压缩",tool_1_desc:"不限制图片大小和数量，不上传至服务器的离线极致压缩",tool_2:"图片转 Base64",tool_2_desc:"不限制图片大小和数量，在线转换成 Base64 编码",tool_3:"图片水印 ",tool_3_desc:"自定义水印文字、字体大小、位置、颜色和透明度",copy_base64:"点击复制 Base64 编码",copy_base64_success:"Base64 编码复制成功",click_download:"点击下载",compress:"压缩",batch_download:"批量下载",add_watermark:"添加水印"},feedback:{text_1:"PicX 是一款基于 GitHub API 开发的图床工具，提供图片上传托管、生成图片链接和常用图片工具箱服务。",text_2:"建议将本站添加到浏览器收藏夹，方便下次使用。",text_3:"如果 PicX 对你有帮助，欢迎赞赏作者，支持开源。",text_4:"郑重声明：请勿使用 PicX 上传违反你当地法律的图片，所造成的一切后果与作者无关。"},region:{CN:"中国大陆",HK:"中国香港",MO:"中国澳门",TW:"中国台湾",SG:"新加坡",JP:"日本",US:"美国",NL:"荷兰"},languages:{"zh-CN":"中文简体","zh-TW":"中文繁体",en:"英文"},toggle_language_msg:"检测到你的 IP 所属地为{region}，是否切换{language}？",authorization:{msg_1:"GitHub OAuth 授权登录已过期，请重新授权",msg_2:"未在 GitHub 安装 PicX APP，暂无操作权限",msg_3:"PicX GitHub APP 安装成功，是否进行授权登录？",msg_4:"授权失败，稍后重试",btn_1:"立即安装",loading_1:"正在授权登录...",text_1:"GitHub OAuth 授权登录",text_2:"填写 GitHub Token 登录",text_3:"正在使用 GitHub OAuth 授权登录",text_4:"GitHub Token 已过期，请重新授权登录",text_5:"正在使用填写 GitHub Token 登录",text_6:"返回登录页",text_7:"切换",text_8:"使用 GitHub OAuth 授权登录必须安装 PicX GitHub APP",text_9:"填写 GitHub Token 登录必须生成具有操作权限的 Token",text_10:"查看教程",text_11:"安装 PicX GitHub APP",text_12:"创建 GitHub Token",text_13:"立即授权"},copy_repo_img:{text_1:"复制仓库图片",text_2:"请输入仓库名称",text_3:"请输入分支名称",text_4:"仓库或分支不正确，请重新输入",text_6:"{repo} 仓库图片复制成功",text_7:"{repo} 仓库图片复制失败，稍后重试",text_8:"复制其他仓库图片",loading_1:"复制中"}};var lt={repo:"倉庫",branch:"分支",dir:"目錄",tip:"提示",delete:"刪除",reset:"重置",confirm:"確定",cancel:"取消",author:"作者",document:"文件",shortcut_key:"快速鍵",username:"名稱",email:"信箱",login:"登入",logout:"退出登入",language:"語言",uploaded:"已上傳",upload:"上傳",rename:"重新命名",copy_link:"複製圖片連結",paste_image:"貼上圖片",copy_success_1:"圖片連結已自動複製到系統剪貼簿",copy_success_2:"圖片連結複製成功",copy_fail_1:"複製失敗",header:{not_login:"未登入",theme:"主題",announcement:{text_1:"網站公告",text_2:"1、PicX v3.0 進一步簡化使用者操作，統一使用內建的倉庫和分支",text_3:"2、如果你需要繼續使用自訂的倉庫和分支，請使用",text_4:"不再提示"}},nav:{config:"圖床配置",upload:"上傳圖片",management:"圖床管理",settings:"圖床設定",toolbox:"工具箱",feedback:"幫助回饋",actions:"快速操作"},actions:{watermark:"圖片浮水印",compress:"壓縮圖片",transform:"轉換 "},config_page:{input_token:"請輸入 GitHub Token ...",one_click_config:"一鍵配置",loading_1:"正在載入使用者資訊 ...",loading_4:"正在載入倉庫目錄資料 ...",loading_5:"正在載入目錄資訊 ...",loading_6:"正在自動設定 ...",placeholder_4:"請輸入新建的目錄 ...",placeholder_5:"請選擇目錄 ...",message_1:"GitHub Token 不能為空",message_2:"使用者資訊取得失敗，請確認 Token 是否正確",message_3:"自動建立 GitHub 倉庫失敗，請稍後再試",message_4:"圖床配置成功",message_5:"一鍵自動設定失敗，請重試",message_6:"目錄不能為空",message_7:"請輸入一個新目錄",message_8:"請選擇倉庫裡的目錄",message_9:"倉庫資訊取得失敗，請稍後重試",dir_mode:"目錄模式",create_new_dir:"新目錄",input_new_dir:"手動輸入一個新目錄",root_dir:"根目錄",date_dir:"日期目錄",date_dir_tip:"自動建立 yyyyMMdd 格式的日期目錄",repo_dir:"倉庫目錄",select_dir:"選擇目錄",reload:"重新載入"},settings_page:{img_name:{title:"圖片名稱設定",md5_switch_name:"MD5",md5_switch_desc:"使用MD5加密圖片名稱",hash_switch_name:"哈希化",hash_switch_desc:"上傳時為圖片名稱增加雜湊值，確保圖片名稱唯一，強烈建議開啟",prefix_switch_name:"加上前綴",prefix_switch_desc:"上傳時為圖片名稱增加前綴，例如：abc-image.jpg，abc- 為前綴",prefix_input_placeholder:"請輸入字首 ..."},img_watermark:{title:"圖片浮水印設定",switch_name:"是否新增浮水印",switch_desc:"開啟後可以自訂浮水印文字、字體大小、位置、顏色和透明度",text:"水印文字",text_input_placeholder:"請輸入浮水印文字，限制 20 字",size:"浮水印大小",color:"水印顏色",opacity:"浮水印透明度",position:"浮水印位置",position_1:"左上角",position_2:"左下角",position_3:"右上角",position_4:"右下角"},img_compress:{title:"圖片壓縮設定",switch_name:"是否壓縮圖片",switch_desc:"開啟後上傳前會自動壓縮圖片，有效縮短圖片上傳與載入時間，強烈建議開啟",radio_group_title:"選擇圖片壓縮演算法",radio_1:"webP",radio_1_desc:"壓縮後圖片格式為 webp，壓縮率較高，大多數瀏覽器支援",radio_2:"mozJPEG",radio_2_desc:"壓縮後圖片格式為 jpg，相容性最好，所有瀏覽器支援",radio_3:"avif",radio_3_desc:"壓縮後圖片格式為 avif，壓縮率極高，部分現代瀏覽器支援"},link_rule:{title:"圖片連結規則配置",select_title:"選擇圖片連結規則",card_title:"配置自訂圖片連結規則",card_table_col_title_1:"型別",card_table_col_title_2:"圖片連結規則",card_table_col_title_3:"操作",input_name_1:"圖片連結類型",input_name_1_rule:"圖片連結類型名稱不能為空",input_name_2:"圖片連結規則",input_name_2_rule:"圖片連結規則不能為空",btn_name_1:"新增圖片連結規則",error_msg_1:"新增失敗，此圖片連結規則已存在",error_msg_2:"{action}失敗，圖片連結規則必須包含 {path}",error_msg_3:"圖片連結規則缺少 {rules}，是否確認{action}？",add:"新增",edit:"編輯"},link_format:{title:"圖片連結格式設定",switch_name:"自動轉換圖片連結格式",switch_desc:"上傳成功後複製的圖片連結會自動轉換成 {type} 格式",select_title:"選擇圖片連結格式",delete_tips:"此動作將永久刪除圖片連結規則"},image_hosting_deploy:{title:"圖床部署",one_click_deploy:"一鍵部署",deploy_to:"部署到 {server}",success:"部署成功",fail:"部署失敗",fail2:"部署失敗，請稍後再試",deploying:"正在部署到 GitHub Pages，該過程持續 1 分鐘左右，請耐心等待 ...",not_deployed:"未部署"},theme:{title:"主題設定",system:"跟隨系統",dark:"黑夜",light:"白晝"},cloud_settings:{tip_1:"偵測到你的設定資料未儲存到雲端倉庫，是否儲存？",tip_2:"偵測到你的雲端倉庫存在設定文件，是否使用？",tip_3:"偵測到你的設定資料有變化，是否同步到雲端倉庫？",tip_4:"本地設定資料與雲端倉庫設定資料一致",success_msg_1:"保存成功",success_msg_2:"更新成功"}},upload_page:{upload_area_text:"拖曳 / 貼上 / 點擊此處選擇圖片",message1:"請先完成圖床配置",message2:"請選擇一個倉庫",message3:"目錄不能為空",message4:"請選擇要上傳的圖片",message5:"圖片上傳成功",message6:"圖片批次上傳成功",message7:"上傳失敗，請稍後重試",message8:"圖片上傳成功",fold:"折疊",expand:"展開",add_hash:"哈希化",add_prefix:"新增前綴",uploading:"正在上傳 ...",tip_9:"{name} 不是圖片格式",tip_10:"{name} 超過 {size} MB，跳過選擇",tip_11:"{name} 上傳失敗"},management_page:{reload:"重新載入",loadingTxt1:"載入中 ...",loadingTxt2:"正在重新命名 ...",loadingTxt3:"刪除中 ...",property:"屬性",delTips:"此操作將會永久刪除圖片",delTips2:"已選取 {total} 張圖片，是否已批次刪除？",message1:"圖片名稱不能為空",message2:"圖片名稱無改變",message3:"重新命名失敗，請重試",message4:"更新成功",message5:"刪除成功",message6:"批次刪除成功",message7:"刪除失敗，請稍後重試",imageName:"圖片名稱",imageSize:"圖片大小",selectAll:"全選",deselectAll:"取消全選",unselect:"取消選擇",batchCopy:"批次複製圖片連結",batchDelete:"批次刪除圖片",selectTotal:"已選擇 {total} 張圖片",contextmenu_1:"從目前位置上傳新圖片",contextmenu_2:"上傳圖片到 {dir}",contextmenu_3:"根目錄",text_1:"請輸入新的圖片名稱",text_2:"立即上傳"},toolbox:{tool_1:"圖片壓縮",tool_1_desc:"不限制圖片大小和數量，不上傳至伺服器的離線極致壓縮",tool_2:"圖片轉 Base64",tool_2_desc:"不限制圖片大小和數量，線上轉換成 Base64 編碼",tool_3:"圖片浮水印 ",tool_3_desc:"自訂浮水印文字、字體大小、位置、顏色和透明度",copy_base64:"點選複製 Base64 編碼",copy_base64_success:"Base64 編碼複製成功",click_download:"點選下載",compress:"壓縮",batch_download:"批次下載",add_watermark:"新增浮水印"},feedback:{text_1:"PicX 是一款基於 GitHub API 開發的圖床工具，提供圖片上傳託管、產生圖片連結和常用圖片工具箱服務。",text_2:"建議將本站新增至瀏覽器收藏夾，方便下次使用。",text_3:"如果 PicX 對你有幫助，歡迎讚賞作者，支持開源。",text_4:"鄭重聲明：請勿使用 PicX 上傳違反你當地法律的圖片，所造成的一切後果與作者無關。"},region:{CN:"中國大陸",HK:"中國香港",MO:"中國澳門",TW:"中國台灣",SG:"新加坡",JP:"日本",US:"美國",NL:"荷蘭"},languages:{"zh-CN":"中文簡體","zh-TW":"中文繁體",en:"英文"},toggle_language_msg:"偵測到你的 IP 所屬地為{region}，是否切換{language}？",authorization:{msg_1:"GitHub OAuth 授權登入已過期，請重新授權",msg_2:"未在 GitHub 安裝 PicX APP，暫無操作權限",msg_3:"PicX GitHub APP 安裝成功，是否進行授權登入？",msg_4:"授權失敗，稍後重試",btn_1:"立即安裝",loading_1:"正在授權登入...",text_1:"GitHub OAuth 授權登入",text_2:"填入 GitHub Token 登入",text_3:"正在使用 GitHub OAuth 授權登入",text_4:"GitHub Token 已過期，請重新授權登入",text_5:"正在使用填入 GitHub Token 登入",text_6:"返回登入頁面",text_7:"切換",text_8:"使用 GitHub OAuth 授權登入必須安裝 PicX GitHub APP",text_9:"填寫 GitHub Token 登入必須產生具有操作權限的 Token",text_10:"檢視教學",text_11:"安裝 PicX GitHub APP",text_12:"建立 GitHub Token",text_13:"立即授權"},copy_repo_img:{text_1:"複製倉庫圖片",text_2:"請輸入倉庫名稱",text_3:"請輸入分支名稱",text_4:"倉庫或分支不正確，請重新輸入",text_6:"{repo} 倉庫圖片複製成功",text_7:"{repo} 倉庫圖片複製失敗，稍後重試",text_8:"複製其他倉庫圖片",loading_1:"複製中"}};var st={repo:"Repository",branch:"Branch",dir:"Directory",tip:"Tip",delete:"Delete",reset:"Reset",confirm:"Confirm",cancel:"Cancel",author:"Author",document:"Document",shortcut_key:"Shortcut Key",username:"Username",email:"Email",login:"Log In",logout:"Log Out",language:"Language",uploaded:"Uploaded",upload:"Upload",rename:"Rename",copy_link:"Copy Image Link",paste_image:"Paste images",copy_success_1:"Image link has been automatically copied to the system clipboard",copy_success_2:"Image link copied successfully",copy_fail_1:"Copy failed",header:{not_login:"Not log in",theme:"Theme",announcement:{text_1:"Website Announcement",text_2:"1. PicX v3.0 further simplifies user operations and uniformly uses built-in repository and branch",text_3:"2. If you need to continue to use customized repository and branch, please use",text_4:"Don't remind again"}},nav:{config:"Image Hosting Configuration",upload:"Upload Image",management:"Image Hosting Management",settings:"Image Hosting Settings",toolbox:"Toolbox",feedback:"Feedback",actions:"Quick Actions"},actions:{watermark:"Image watermark",compress:"Compress image",transform:"Transform "},config_page:{input_token:"Please enter GitHub Token...",one_click_config:"One-Click Configuration",loading_1:"Loading user information...",loading_4:"Loading repository directory data...",loading_5:"Loading directory information...",loading_6:"Auto-configuring...",placeholder_4:"Please enter the name of the new directory...",placeholder_5:"Please select a directory...",message_1:"GitHub Token cannot be empty",message_2:"Failed to retrieve user information. Please check if the Token is correct",message_3:"Auto-creation of GitHub repository failed. Please try again later",message_4:"Image hosting configuration successful",message_5:"One-click auto-configuration failed. Please retry",message_6:"Directory cannot be empty",message_7:"Please enter a new directory",message_8:"Please select a directory in the repository",message_9:"Failed to retrieve repository information. Please try again later",dir_mode:"Directory Mode",create_new_dir:"Create New Directory",input_new_dir:"Manually input a new directory",root_dir:"Root Directory",date_dir:"Date Directory",date_dir_tip:"Automatically create directories in the format yyyyMMdd",repo_dir:"Repository Directory",select_dir:"Select Directory",reload:"Reload"},settings_page:{img_name:{title:"Image Name Settings",md5_switch_name:"MD5",md5_switch_desc:"Use MD5 to encrypt the image name.",hash_switch_name:"Hashing",hash_switch_desc:"Add a hash value to the image name during upload to ensure uniqueness. Highly recommended to enable.",prefix_switch_name:"Add Prefix",prefix_switch_desc:"Add a prefix to the image name during upload, for example: abc-image.jpg, where 'abc-' is the prefix.",prefix_input_placeholder:"Enter prefix ..."},img_watermark:{title:"Image Watermark Settings",switch_name:"Add Watermark",switch_desc:"Customize watermark text, font size, position, color, and opacity when enabled.",text:"Text",text_input_placeholder:"Enter watermark text, limit to 20 characters",size:"Size",color:"Color",opacity:"Opacity",position:"Position",position_1:"Top Left",position_2:"Bottom Left",position_3:"Top Right",position_4:"Bottom Right"},img_compress:{title:"Image Compression Settings",switch_name:"Compress Images",switch_desc:"Automatically compress images before upload, reducing upload and loading times. Highly recommended to enable.",radio_group_title:"Choose Image Compression Algorithm",radio_1:"WebP",radio_1_desc:"Resulting format is webp, offering high compression rates, supported by most browsers",radio_2:"MozJPEG",radio_2_desc:"Resulting format is jpg, highest compatibility with all browsers",radio_3:"AVIF",radio_3_desc:"Resulting format is avif, extremely high compression rates, supported by some modern browsers"},link_rule:{title:"Image Link Rules Configuration",select_title:"Select Image Link Rule",card_title:"Configure Custom Image Link Rules",card_table_col_title_1:"Type",card_table_col_title_2:"Image Link Rule",card_table_col_title_3:"Action",input_name_1:"Image Link Type",input_name_1_rule:"Image link type name cannot be empty",input_name_2:"Image Link Rule",input_name_2_rule:"Image link rule cannot be empty",btn_name_1:"Add Image Link Rule",error_msg_1:"Failed to add. This image link rule already exists",error_msg_2:"{action} failed. Image link rule must include {path}",error_msg_3:"Image link rule is missing {rules}. Confirm {action}?",add:"Add",edit:"Edit"},link_format:{title:"Image Link Format Settings",switch_name:"Automatically Convert Image Link Format",switch_desc:"Automatically converts copied image links to {type} format after successful upload",select_title:"Select Image Link Format",delete_tips:"This action will permanently delete the image link rule"},image_hosting_deploy:{title:"Image Hosting Deployment",one_click_deploy:"One-Click Deploy",deploy_to:"Deploy to {server}",success:"Deployment successful",fail:"Deployment failed",fail2:"Deployment failed, please try again later",deploying:"Deploying to GitHub Pages, this process takes about 1 minute, please be patient...",not_deployed:"Not deployed"},theme:{title:"Theme Settings",system:"System",dark:"Dark",light:"Light"},cloud_settings:{tip_1:"Detected that your settings data is not saved to the cloud repository. Save now?",tip_2:"Detected that your cloud repository has settings files. Use them?",tip_3:"Detected changes in your settings data. Synchronize with the cloud repository?",tip_4:"Local and cloud repository settings data are consistent",success_msg_1:"Save successful",success_msg_2:"Update successful"}},upload_page:{upload_area_text:"Drag / Paste / Click here to select images",message1:"Please complete image hosting configuration first",message2:"Please select a repository",message3:"Directory cannot be empty",message4:"Please select images to upload",message5:"Image uploaded successfully",message6:"Bulk image upload successful",message7:"Upload failed, please try again later",message8:"Image uploaded successfully",fold:"Fold",expand:"Expand",add_hash:"Add Hash",add_prefix:"Add Prefix",uploading:"Uploading...",tip_9:"{name} is not an image format",tip_10:"{name} exceeds {size} MB, skip selection",tip_11:"{name} upload failed"},management_page:{reload:"Reload",loadingTxt1:"Loading...",loadingTxt2:"Renaming...",loadingTxt3:"Deleting...",property:"Properties",delTips:"This action will permanently delete the image",delTips2:"Selected {total} images, do you want to delete them in bulk?",message1:"Image name cannot be empty",message2:"No changes in image name",message3:"Rename failed, please try again",message4:"Update successful",message5:"Deletion successful",message6:"Bulk deletion successful",message7:"Deletion failed, please try again later",imageName:"Image Name",imageSize:"Image Size",selectAll:"Select All",deselectAll:"Deselect All",unselect:"Deselect",batchCopy:"Batch Copy Image Links",batchDelete:"Batch Delete Images",selectTotal:"Selected {total} images",contextmenu_1:"Upload new images from the current location",contextmenu_2:"Upload images to {dir}",contextmenu_3:"Root Directory",text_1:"Please enter a new image name",text_2:"Upload now"},toolbox:{tool_1:"Image Compression",tool_1_desc:"Ultra-compression offline without limitations on image size and quantity, without uploading to the server",tool_2:"Image to Base64",tool_2_desc:"Convert images to Base64 encoding online without limitations on size and quantity",tool_3:"Image Watermark",tool_3_desc:"Customize watermark text, font size, position, color, and opacity",copy_base64:"Click to copy Base64 encoding",copy_base64_success:"Base64 encoding copied successfully",click_download:"Click to download",compress:"Compress",batch_download:"Batch Download",add_watermark:"Add Watermark"},feedback:{text_1:"PicX is an image hosting tool developed based on the GitHub API, providing services for image upload hosting, generating image links, and common image tools.",text_2:"It is recommended to add this site to your browser bookmarks for convenient use in the future.",text_3:"If PicX is helpful to you, feel free to appreciate the author and support open source.",text_4:"Disclaimer: Do not use PicX to upload images that violate local laws. The author is not responsible for any consequences."},region:{CN:"Mainland China",HK:"Hong Kong, China",MO:"Macau, China",TW:"Taiwan, China",SG:"Singapore",JP:"Japan",US:"United States",NL:"Netherlands"},languages:{"zh-CN":"Simplified Chinese","zh-TW":"Traditional Chinese",en:"English"},toggle_language_msg:"Detected that your IP belongs to {region}. Do you want to switch to {language}?",authorization:{msg_1:"GitHub OAuth authorization has expired. Please reauthorize.",msg_2:"PicX APP is not installed on GitHub, no operational permissions currently.",msg_3:"PicX GitHub APP installed successfully. Would you like to authorize and log in?",msg_4:"Authorization failed. Please try again later.",btn_1:"Install Now",loading_1:"Authorizing login...",text_1:"GitHub OAuth Authorization Login",text_2:"Login with GitHub Token",text_3:"Logging in using GitHub OAuth Authorization",text_4:"GitHub Token has expired. Please reauthorize login.",text_5:"Logging in using GitHub Token",text_6:"Return to Login Page",text_7:"Switch",text_8:"GitHub OAuth Authorization Login requires PicX GitHub APP installation.",text_9:"Login with GitHub Token requires generating a Token with operational permissions.",text_10:"View Tutorial",text_11:"Install PicX GitHub APP",text_12:"Create GitHub Token",text_13:"Authorize now"},copy_repo_img:{text_1:"Copy repository images",text_2:"Please enter the repository name",text_3:"Please enter the branch name",text_4:"The repository or branch is incorrect, please re-enter",text_6:"{repo} repository images copied successfully",text_7:"{repo} repository images copy failed, try again later",text_8:"Copy other repository images",loading_1:"Copying"}};const ot=c.createI18n({locale:"zh-CN",messages:{"zh-CN":it,"zh-TW":lt,en:st}}),nt=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},rt=()=>Number(Math.random().toString().substring(2,4)+Date.now()).toString(36),ct=(e,t)=>{navigator.clipboard.writeText(e).then((()=>{t&&t()}))},dt=e=>{for(const t in e)switch(nt(e[t])){case"object":dt(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1}},ut=(e,t)=>{for(const a in t)"object"!==nt(t[a])?e[a]=t[a]:(Object.hasOwn(e,a)||(e[a]={}),ut(e[a],t[a]))},mt=(e="yyyy-MM-dd hh:mm:ss",t=Date.now())=>{function a(e){return`00${e}`.substr(e.length)}const i=new Date(t);/(y+)/.test(e)&&(e=e.replace(RegExp.$1,`${i.getFullYear()}`.substr(4-RegExp.$1.length)));const l={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds()};for(const s in l)if(new RegExp(`(${s})`).test(e)){const t=`${l[s]}`;e=e.replace(RegExp.$1,1===RegExp.$1.length?t:a(t))}return e},gt=e=>{e&&(window.document.title=`${ot.global.t(e)} | PicX`)},pt=(e,t)=>{function a(e){const t={};for(const[i,l]of Object.entries(e))if("object"==typeof l&&null!==l){const e=a(l);for(const[a,l]of Object.entries(e))t[`${i}.${a}`]=l}else t[i]=l;return t}return Object.entries(a(e)).toString()===Object.entries(a(t)).toString()};var _t,ht,ft,vt,bt,yt,wt,xt,It,St,kt,Tt,Lt,Et,Ot,Ct,At,Pt;async function $t(e,t){const{text:a,fontSize:i,position:l,textColor:s,opacity:o}=t,[n,r,c]=(d=s,d?(d=d.replace("#",""),`${parseInt(d.substring(0,2),16)}, ${parseInt(d.substring(2,4),16)}, ${parseInt(d.substring(4,6),16)}`):"255,255,255").split(",");var d;const u=await function(e){return new Promise(((t,a)=>{const i=new FileReader;i.onload=()=>{const e=new Image;e.setAttribute("crossOrigin","Anonymous"),e.onload=()=>t(e),e.onerror=a,e.src=i.result},i.onerror=a,i.readAsDataURL(e)}))}(e),m=document.createElement("canvas"),g=m.getContext("2d");m.width=u.width,m.height=u.height,g.drawImage(u,0,0),g.font=`bold ${i}px Arial`,g.strokeStyle=`rgba(0, 0, 0, ${o})`,g.lineWidth=3,g.fillStyle=`rgba(${n}, ${r}, ${c}, ${o})`;let p=0,_=0;switch(l){case Lt.leftTop:p=10,_=i+5;break;case Lt.rightTop:p=m.width-g.measureText(a).width-10,_=i+5;break;case Lt.leftBottom:p=10,_=m.height-15;break;case Lt.rightBottom:p=m.width-g.measureText(a).width-10,_=m.height-15}return g.strokeText(a,p,_),g.fillText(a,p,_),new Promise((t=>{m.toBlob((a=>{if(a){const i=new File([a],e.name,{type:e.type});t(i)}else t(null)}),e.type)}))}(ht=_t||(_t={})).uploaded="uploaded",ht.allUploaded="allUploaded",ht.uploadFail="uploadFail",(vt=ft||(ft={})).deleted="deleted",vt.allDeleted="allDeleted",vt.deleteFail="deleteFail",(yt=bt||(bt={})).mozJPEG="mozJPEG",yt.avif="avif",yt.webP="webP",(xt=wt||(wt={})).GitHub="GitHub",xt.GitHubPages="GitHub Pages",xt.jsDelivr="jsDelivr",xt.ChinaJsDelivr="ChinaJsDelivr",xt.Statically="Statically",(St=It||(It={})).rootDir="rootDir",St.dateDir="dateDir",St.repoDir="repoDir",St.newDir="newDir",(Tt=kt||(kt={})).large="large",Tt.default="default",Tt.small="small",(Et=Lt||(Lt={})).leftTop="leftTop",Et.leftBottom="leftBottom",Et.rightTop="rightTop",Et.rightBottom="rightBottom",(Ct=Ot||(Ot={})).system="system",Ct.light="light",Ct.dark="dark",(Pt=At||(At={})).zhCN="zh-CN",Pt.zhTW="zh-TW",Pt.en="en";const Dt=e=>{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null},Gt=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},Ut=(e,t)=>{sessionStorage.setItem(e,JSON.stringify(t))},Rt="https://api.github.com",zt=d.create({baseURL:Rt,timeout:3e5});function Mt(e){const{success422:t,noShowErrMsg:a,noCache:i}=e;return i&&(e.cache={maxAge:0},e.params=e.params?e.params:{},e.params.timestamp=Date.now(),delete e.noCache),new Promise((i=>{zt.request(e).then((e=>{const{status:t,data:a}=e;i(!e||200!==t&&201!==t&&204!==t?null:a||"SUCCESS")})).catch((e=>{var l;if(t&&422===(null==e?void 0:e.status))i((null==e?void 0:e.data)||"SUCCESS");else{const t=null==e?void 0:e.status,s=null==(l=null==e?void 0:e.data)?void 0:l.message;a||(console.error("PicX Error // ",e),void 0!==t&&void 0!==s&&u.error({duration:6e3,message:`Code: ${t}, Message: ${s}`})),i(null)}}))}))}zt.defaults.headers["Content-Type"]="application/json",zt.interceptors.request.use((e=>{var t;const a=Dt("PICX_CONFIG");if(a){const{token:i}=a;(null==(t=e.baseURL)?void 0:t.includes(Rt))&&i&&(e.headers.Authorization=`Bearer ${i}`)}return e}),(e=>Promise.reject(e))),zt.interceptors.response.use((e=>e),(e=>((null==e?void 0:e.response)||u.error({duration:6e3,message:`${e}`}),Promise.reject(e.response))));const Nt=(e,t="")=>{const{owner:a,repo:i,branch:l}=e;return new Promise((async e=>{const s=await Mt({url:`/repos/${a}/${i}/contents/${t}`,method:"GET",noShowErrMsg:!0,params:{ref:l}});s&&s.length?e(s.filter((e=>"dir"===e.type)).map((e=>({value:e.name,label:e.name})))):e([])}))},Ht=(e,t="")=>{const{owner:a,repo:i,branch:l}=e;return new Promise((async e=>{const s=await Mt({url:`/repos/${a}/${i}/contents/${t}`,method:"GET",noCache:!0,params:{ref:l}});s&&s.length?(s.filter((e=>"dir"===e.type)).forEach((e=>Ca.dispatch("DIR_IMAGE_LIST_ADD_DIR",e.path))),setTimeout((()=>{s.filter((e=>"file"===e.type&&aa(ta(e.name)))).forEach((e=>{Ca.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",Jt(e,t))}))}),120),e(!0)):e(null)}))},jt=(e,t,a)=>Mt({url:`/repos/${e}/${t}/branches/${a}`,method:"GET",noCache:!0}),Vt=async(e,t)=>{var a;const{owner:i,repo:l,branch:s}=e,o=m.service({text:ot.global.t("settings_page.image_hosting_deploy.deploying")}),n=(e=!1)=>{t&&t(e),o.close()};try{const e=await((e,t)=>new Promise((async a=>{const i=await Mt({url:`/repos/${e}/${t}/branches`,method:"GET",noCache:!0});i&&i.length?a(i.filter((e=>!e.protected)).map((e=>({value:e.name,label:e.name}))).reverse()):a([])})))(i,l),t=e.some((e=>"gh-pages"===e.value));let o=!0;if(t){o=!1;if(!(await zt.delete(`/repos/${i}/${l}/git/refs/heads/gh-pages`)))return void n(!1);o=!0}if(o){let e="";const t=await Mt({url:`/repos/${i}/${l}/git/refs/heads/${s}`,method:"GET"});if(t&&(e=null==(a=null==t?void 0:t.object)?void 0:a.sha),!e)return void n(!1);(await Mt({url:`/repos/${i}/${l}/git/refs`,method:"POST",data:{ref:"refs/heads/gh-pages",sha:e}})).object.sha?setTimeout((()=>{n(!0)}),5e4):n(!1)}}catch(r){console.error(r),n(!1)}},Bt=(e,t,a,i)=>Mt({url:`/repos/${e}/${t}/contents/${a}`,method:"DELETE",data:{owner:e,repo:t,path:a,message:"Delete image via PicX (https://github.com/XPoet/picx)",sha:i}}),Ft=(e,t,a)=>Mt({url:`/repos/${t}/${a}/git/blobs`,method:"POST",data:{owner:t,repo:a,content:e,encoding:"base64"}}),Xt=(e,t,a,i)=>{var l,s,o;return Mt({url:`/repos/${e}/${t}/git/trees`,method:"POST",data:{tree:a.map((e=>({path:e.path,mode:"100644",type:"blob",sha:e.sha}))),base_tree:(null==(o=null==(s=null==(l=null==i?void 0:i.commit)?void 0:l.commit)?void 0:s.tree)?void 0:o.sha)||null}})},qt=(e,t,a,i,l)=>Mt({url:`/repos/${e}/${t}/git/commits`,method:"POST",data:{tree:a.sha,parents:[i.commit.sha],message:l||"Upload images via PicX (https://github.com/XPoet/picx)"}}),Wt=(e,t,a,i)=>Mt({url:`/repos/${e}/${t}/git/refs/heads/${a}`,method:"PATCH",data:{sha:i}}),Jt=(e,t)=>({type:"image",uuid:rt(),dir:t,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size,checked:!1,deployed:!0});const Kt=(e,t=!1)=>{e.forEach((e=>{e.deleting=t}))};async function Zt(e,t){if(1===e.length)return await async function(e,t){e.deleting=!0;const{owner:a,repo:i}=t,{path:l,sha:s}=e;return new Promise((async t=>{const o=await Bt(a,i,l,s);e.deleting=!1,o?(t(!0),await Ca.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),await Ca.dispatch("DIR_IMAGE_LIST_REMOVE",e)):t(!1)}))}(e[0],t)?ft.deleted:ft.deleteFail;try{return await async function(e,t){Kt(e,!0);const{owner:a,repo:i,branch:l}=t,s=await jt(a,i,l);if(!s)throw Kt(e,!1),new Error("获取分支信息失败");const o=await Xt(a,i,e.map((e=>({path:e.path,sha:null}))),s);if(!o)throw Kt(e,!1),new Error("创建 tree 失败");const n=await qt(a,i,o,s);if(!n)throw Kt(e,!1),new Error("创建 commit 失败");if(!(await Wt(a,i,l,n.sha)))throw Kt(e,!1),new Error("更新 ref 失败");e.forEach((e=>{e.deleting=!1,Ca.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),Ca.dispatch("DIR_IMAGE_LIST_REMOVE",e)}))}(e,t),ft.allDeleted}catch(a){return console.error(a),ft.deleteFail}}function Yt(e,t){const a=document.createElement("canvas"),i=a.getContext("2d"),l=new Image;return l.crossOrigin="Anonymous",l.src=e,new Promise((e=>{l.onload=()=>{const{width:s}=l,{height:o}=l;a.width=s,a.height=o,null==i||i.drawImage(l,0,0,s,o);const n=a.toDataURL(`image/${t}`);e(n)},l.onerror=()=>{e(null)}}))}function Qt(e){return new Promise((t=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>{const e=a.result;t(e)},a.onerror=()=>t(null)}))}function ea(e){const t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=e.name,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)}const ta=e=>{const t=e.lastIndexOf(".");return e.slice(t+1)},aa=e=>(e=e.toLowerCase(),/(png|jpg|jpeg|gif|webp|awebp|avif|svg\+xml|svg|x-icon|vnd.microsoft.icon|ico)$/.test(e)),ia=e=>e?Number((e/1024).toFixed(0)):e,la=e=>new Promise((async t=>{e||t(null),aa(e.type)||(u.error(ot.global.t("upload_page.tip_9",{name:e.name})),t(null));const a=await Qt(e)||"";ia(a.length)>=30720&&(u.error(ot.global.t("upload_page.tip_10",{name:e.name,size:30})),t(null)),t({uuid:rt(),base64:a,file:e})})),sa=async(e,t)=>{if(a=(a=e.type).toLowerCase(),/(png|jpg|jpeg|webp|avif)$/.test(a)){return new g(e,{encoderState:{type:t,options:p[t].meta.defaultOptions},processorState:_,preprocessorState:h}).process()}var a;return e},oa=e=>{const t=f((()=>Ca.getters.getUserConfigInfo)).value,a=f((()=>Ca.getters.getUserSettings)).value,{selected:i}=a.imageLinkType,{rule:l}=a.imageLinkType.presetList[i];if(l){const{owner:a,repo:i,branch:s}=t;return l.replaceAll("{{owner}}",a).replaceAll("{{repo}}",i).replaceAll("{{branch}}",s).replaceAll("{{path}}",e.path)}return null},na=(e,t)=>{var a;const i=f((()=>Ca.getters.getUserSettings)).value;if(i.imageLinkFormat.enable){const l=i.imageLinkFormat.selected,s=null==(a=i.imageLinkFormat.presetList.find((e=>e.name===l)))?void 0:a.format;if(s)return s.replaceAll("imageLink",e||"").replaceAll("imageName",t.split(".")[0])}return e},ra=(e=!1)=>{const t=e?ot.global.t("copy_success_1"):ot.global.t("copy_success_2");u({type:e?"info":"success",message:t,duration:e?6e3:4e3})},ca=(e,t=!1)=>{const a=na(oa(e),e.name);a?ct(a,(()=>{ra(t)})):u.error({message:ot.global.t("copy_fail_1")})},da=(e,t=!1)=>{if((null==e?void 0:e.length)>0){let a="";e.forEach(((t,i)=>{const l=na(oa(t),t.name);a+=`${l}${i<e.length-1?"\n":""}`})),ct(a,(()=>{ra(t)}))}},ua=()=>{const{platform:e}=navigator;return e.includes("Mac")?"mac":e.includes("Win")?"win":e.includes("Linux")?"linux":null},ma="https://github.com",ga=e=>{const{owner:t}=e;return`${ma}/${t}`},pa=e=>{const{owner:t,repo:a}=e;return`${ma}/${t}/${a}`},_a={state:{name:"dirImageListModule",dirObject:(()=>{const e=localStorage.getItem("PICX_MANAGEMENT");return e?JSON.parse(e):Qe("/","/")})()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:t},a){if("/"===a)return;const i=(e,t,a)=>{if(e){e.childrenDirs.some((e=>e.dir===t))||e.childrenDirs.push(Qe(t,a));return e.childrenDirs.find((e=>e.dir===t))||Qe(t,a)}return Qe(t,a)},l=a.split("/");let s="",o=e.dirObject;for(let n=0,r=l.length;n<r;n++){const e=l[n];s+=`${n>0?"/":""}${e}`,o=i(o,e,s),0===n&&t("USER_CONFIG_INFO_ADD_DIR",e)}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:t},a){if("/"===a)return;const i=a.split("/");let l=e.dirObject;i.forEach(((t,a)=>{l=((t,a,i)=>{if("/"===a)return e.dirObject;const l=t.childrenDirs.find((e=>e.dir===a));if(!l)return t;if(i){const e=t.childrenDirs.findIndex((e=>e.dir===a));-1!==e&&t.childrenDirs.splice(e,1)}return l})(l,t,a===i.length-1)})),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:t},a){let i=e.dirObject;if("/"===a.dir)i.imageList.some((e=>e.name===a.name))||i.imageList.push(a);else{const t=a.dir.split("/");let l="";t.forEach(((s,o)=>{l+=`${o>0?"/":""}${s}`,i=((t,a,i,l,s=!1)=>{var o;if(!t)return e.dirObject;let n=null==(o=t.childrenDirs)?void 0:o.find((e=>e.dir===a));return n||(n={type:"dir",dir:a,dirPath:i,childrenDirs:[],imageList:[]},t.childrenDirs.push(n)),s&&!n.imageList.some((e=>e.name===l.name))&&n.imageList.push(l),n})(i,s,l,a,o===t.length-1)}))}t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:t},a){const i=(e,t)=>{if(e.length){const a=e.findIndex((e=>e.uuid===t));-1!==a&&e.splice(a,1)}},{dir:l,uuid:s}=a;if("/"===l)return i(e.dirObject.imageList,s),void t("DIR_IMAGE_LIST_PERSIST");const o=l.split("/");let n=e.dirObject;o.forEach(((l,s)=>{if(n=((t,a,l,s)=>{if(!t)return e.dirObject;const o=t.childrenDirs.find((e=>e.dir===a));return o?(o.dir===a&&s&&i(o.imageList,l.uuid),o):e.dirObject})(n,l,a,s===o.length-1),!n.imageList.length&&!n.childrenDirs.length){const a=(e=>{if("/"===e)return[];const t=e.split("/"),a=[];let i="";return t.forEach(((e,t)=>{i+=`${t>0?"/":""}${e}`,a.unshift(i)})),a})(n.dirPath);a.forEach((a=>{const i=tt(a,e.dirObject);if(i&&!i.imageList.length&&!i.childrenDirs.length){const{dirPath:e}=(e=>{if("/"===e)return{currentDir:"/",dirPath:"/"};const t=e.split("/");return 1===t.length?{currentDir:"/",dirPath:"/"}:t.length>1?(t.length-=1,{currentDir:t[t.length-1],dirPath:t.join("/")}):{currentDir:"/",dirPath:"/"}})(a),i=e,l=e;let s=l.split("/");"/"===e&&(s=[],t("USER_CONFIG_INFO_REMOVE_DIR",a)),t("SET_USER_CONFIG_INFO",{viewDir:i,selectedDir:l,selectedDirList:s}),t("DIR_IMAGE_LIST_REMOVE_DIR",a)}}))}}))},DIR_IMAGE_LIST_INIT_DIR({state:e,dispatch:t},a){let i=e.dirObject;if("/"===a)return i.imageList=[],i.childrenDirs=[],void t("DIR_IMAGE_LIST_PERSIST");const l=a.split("/");l.forEach(((t,a)=>{i=((t,a,i)=>{var l;if(!t)return e.dirObject;const s=null==(l=t.childrenDirs)?void 0:l.find((e=>e.dir===a));return s?(i&&(s.imageList=[],s.childrenDirs=[]),s):e.dirObject})(i,t,a===l.length-1)})),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_PERSIST({state:e}){Gt("PICX_MANAGEMENT",e.dirObject)},DIR_IMAGE_LOGOUT({state:e,dispatch:t}){e.dirObject=Qe("/","/"),t("DIR_IMAGE_LIST_PERSIST")}},getters:{getDirObject:e=>e.dirObject}},ha=()=>{const e={token:"",id:"",owner:"",email:"",name:"",avatarUrl:"",repo:"",branch:"",selectedDir:"",dirMode:It.repoDir,dirList:[],logined:!1,selectedDirList:[],viewDir:"",repoPrivate:!1},t=localStorage.getItem("PICX_CONFIG");return t?(ut(e,JSON.parse(t)),e.dirMode===It.dateDir&&(e.selectedDir=mt("yyyyMMdd")),e):e},fa={state:{userConfigInfo:ha()},actions:{USER_CONFIG_INFO_RESET({state:e}){e.userConfigInfo=ha()},SET_USER_CONFIG_INFO({state:e,dispatch:t},a){for(const i in a)e.userConfigInfo.hasOwnProperty(i)&&(e.userConfigInfo[i]=a[i]);t("USER_CONFIG_INFO_PERSIST")},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:t},a){e.userConfigInfo.dirList.some((e=>e.value===a))||(e.userConfigInfo.dirList.push({label:a,value:a}),t("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:t},a){const{dirList:i}=e.userConfigInfo;if(i.some((e=>e.value===a))){const e=i.findIndex((e=>e.value===a));i.splice(e,1),t("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){(e=>{const{selectedDir:t,branch:a,dirMode:i}=e.userConfigInfo;if("newDir"===i){const a=t.split("");let i=0,l="";const s=[" ",".","、",",","，","!","？","?"];for(let e=0;e<a.length&&(s.some((t=>t===a[e]))&&(a[e]="-"),"/"===a[e]&&(i+=1),!(i>=5));e++)l+=a[e];e.userConfigInfo.selectedDir=l}e.userConfigInfo.branch=a.replace(/\s+/g,"-")})(e),localStorage.setItem("PICX_CONFIG",JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_LOGOUT({state:e}){dt(e.userConfigInfo)}},getters:{getUserLoginStatus:e=>e.userConfigInfo.logined,getUserConfigInfo:e=>e.userConfigInfo,getUserViewDir:e=>e.userConfigInfo.viewDir}},va={state:{imgCardArr:[]},mutations:{IMAGE_CARD(e,{imageObj:t}){const{uuid:a,checked:i}=t;i&&e.imgCardArr.forEach((e=>{e.uuid===a&&(e.checked=!0)}))},REPLACE_IMAGE_CARD(e,{checkedImgArr:t}){t.length>0?e.imgCardArr=t:e.imgCardArr=[]}},actions:{},getters:{getImageCardArr:e=>e.imgCardArr,getImageCardCheckedArr:e=>e.imgCardArr.filter((e=>e.checked))}},ba={state:{isActive:!1,isPaste:!1,pressShiftKey:!1,activeInfo:null},mutations:{SET_UPLOAD_AREA_STATE(e,t){for(const a in t)e[a]=t[a]},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.isActive=!1,e.isPaste=!1,e.pressShiftKey=!1,e.activeInfo=null}},getters:{getUploadAreaState:e=>e}};var ya,wa;(wa=ya||(ya={}))[wa.add=0]="add",wa[wa.edit=1]="edit";const xa=(e,t,a)=>{const i=t===ya.add?ot.global.t("settings_page.link_rule.add"):ot.global.t("settings_page.link_rule.edit"),l=[];if(!e.rule.includes("{{path}}"))return u.error(ot.global.t("settings_page.link_rule.error_msg_2",{action:i,path:"{{path}}"})),void a(!1);if(e.rule.includes("{{owner}}")||l.push("{{owner}}"),e.rule.includes("{{repo}}")||l.push("{{repo}}"),e.rule.includes("{{branch}}")||l.push("{{branch}}"),l.length){const e=ot.global.t("settings_page.link_rule.error_msg_3",{action:i,rules:l.join("、")});v.confirm(e,`${i}`,{type:"warning",showClose:t===ya.add,showCancelButton:t===ya.add}).then((()=>{a(!0)})).catch((()=>{a(!1)}))}else a(!0)},Ia={imageName:{enableMD5:!1,enableHash:!0,addPrefix:{enable:!1,prefix:""}},compress:{enable:!0,encoder:bt.webP},imageLinkType:{selected:wt.GitHub,presetList:{[`${wt.GitHubPages}`]:{id:rt(),name:wt.GitHubPages,rule:"https://{{owner}}.github.io/{{repo}}/{{path}}"},[`${wt.GitHub}`]:{id:rt(),name:wt.GitHub,rule:"https://github.com/{{owner}}/{{repo}}/raw/{{branch}}/{{path}}"},[`${wt.jsDelivr}`]:{id:rt(),name:wt.jsDelivr,rule:"https://cdn.jsdelivr.net/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},[`${wt.Statically}`]:{id:rt(),name:wt.Statically,rule:"https://cdn.statically.io/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"},[`${wt.ChinaJsDelivr}`]:{id:rt(),name:wt.ChinaJsDelivr,rule:"https://jsd.cdn.zzko.cn/gh/{{owner}}/{{repo}}@{{branch}}/{{path}}"}}},imageLinkFormat:{enable:!1,selected:"Markdown",presetList:[{name:"Markdown",format:"![imageName](imageLink)"},{name:"HTML",format:'<img src="imageLink" alt="imageName" />'},{name:"BBCode",format:"[img]imageLink[/img]"}]},starred:!1,watermark:{enable:!1,text:"PicX",fontSize:50,position:Lt.rightBottom,textColor:"#FFFFFF",opacity:.5},showAnnouncement:!0},Sa={state:{userSettings:(()=>{const e=Dt("PICX_SETTINGS");return e&&ut(Ia,e),Ia})(),cloudSettings:null,globalSettings:(()=>{const e={showAnnouncement:!0,folded:!1,elementPlusSize:kt.default,language:At.zhCN,languageToggleTip:!0,theme:Ot.system,useCloudSettings:!1},t=(e=>{const t=window.sessionStorage.getItem(e);return t?JSON.parse(t):null})("PICX_GLOBAL_SETTINGS");return t&&ut(e,t),e})()},actions:{SET_USER_SETTINGS({state:e,dispatch:t},a){for(const i in a)Object.hasOwn(e.userSettings,i)&&(e.userSettings[i]=a[i]);t("USER_SETTINGS_PERSIST")},SET_CLOUD_SETTINGS({state:e},t){e.cloudSettings=t},SET_GLOBAL_SETTINGS({state:e},t){for(const a in t)e.globalSettings[a]=t[a];Ut("PICX_GLOBAL_SETTINGS",e.globalSettings)},ADD_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},{rule:a}){const i=e.userSettings.imageLinkType.presetList;Object.hasOwn(i,a.name)?u.error(ot.global.t("settings_page.link_rule.error_msg_1")):xa(a,ya.add,(i=>{i&&(e.userSettings.imageLinkType.presetList[a.name]=a,t("USER_SETTINGS_PERSIST"))}))},UPDATE_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},{rule:a}){xa(a,ya.edit,(i=>{i&&(e.userSettings.imageLinkType.presetList[a.name].rule=a.rule,t("USER_SETTINGS_PERSIST"))}))},DEL_IMAGE_LINK_TYPE_RULE({state:e,dispatch:t},a){delete e.userSettings.imageLinkType.presetList[a.name],t("USER_SETTINGS_PERSIST")},USER_SETTINGS_PERSIST({state:e}){Gt("PICX_SETTINGS",e.userSettings)},USER_GLOBAL_PERSIST({state:e}){Ut("PICX_GLOBAL_SETTINGS",e.globalSettings)},USER_SETTINGS_LOGOUT({state:e}){e.userSettings=Ia}},getters:{getUserSettings:e=>e.userSettings,getCloudSettings:e=>e.cloudSettings,getGlobalSettings:e=>e.globalSettings}},ka={state:{toolboxImageList:[]},mutations:{},actions:{TOOLBOX_IMG_LIST_ADD({state:e},t){e.toolboxImageList.unshift(t)},TOOLBOX_IMG_LIST_REMOVE({state:e},t){if(e.toolboxImageList.length>0){const a=e.toolboxImageList.findIndex((e=>e.uuid===t));-1!==a&&e.toolboxImageList.splice(a,1)}},TOOLBOX_IMG_LIST_RESET({state:e}){e.toolboxImageList=[]}},getters:{getToolboxImageList:e=>e.toolboxImageList}},Ta={state:{uploadImageList:[]},mutations:{},actions:{UPLOAD_IMG_LIST_ADD({state:e},t){e.uploadImageList.unshift(t)},UPLOAD_IMG_LIST_REMOVE({state:e},t){if(e.uploadImageList.length>0){const a=e.uploadImageList.findIndex((e=>e.uuid===t));-1!==a&&0===e.uploadImageList[a].uploadStatus.progress&&e.uploadImageList.splice(a,1)}},UPLOAD_IMG_LIST_RESET({state:e}){e.uploadImageList=[]}},getters:{getUploadImageList:e=>e.uploadImageList}},La={state:{authorizationInfo:(()=>{const e={authorized:!1,installed:null,token:"",tokenCreateTime:0,code:"",codeCreateTime:0,installationId:"",manualToken:"",isAutoAuthorize:!1,authorizing:!1},t=Dt("PICX_AUTHORIZATION");return t?(ut(e,t),e):e})()},actions:{SET_GITHUB_AUTHORIZATION_INFO({state:e,dispatch:t},a){for(const i in a)Object.hasOwn(e.authorizationInfo,i)&&(e.authorizationInfo[i]=a[i]);t("GITHUB_AUTHORIZATION_INFO_PERSIST")},GITHUB_AUTHORIZATION_INFO_PERSIST({state:e}){Gt("PICX_AUTHORIZATION",e.authorizationInfo)}},getters:{getGitHubAuthorizationInfo:e=>e.authorizationInfo}};var Ea,Oa;(Oa=Ea||(Ea={}))[Oa.githubPages=0]="githubPages",Oa[Oa.vervel=1]="vervel";const Ca=b({modules:{dirImageListModule:_a,userConfigInfoModule:fa,imageCardModule:va,uploadAreaModule:ba,userSettingsModule:Sa,toolboxImageListModule:ka,uploadImageListModule:Ta,githubAuthorizeModule:La,deployStatusModule:{state:{github:{uuid:rt(),status:null,latestTime:null,type:Ea.githubPages}},actions:{SET_DEPLOY_STATUS_INFO({state:e},t){ut(e,t)}},getters:{getDeployStatusInfo:e=>e}}},state:{rootName:"root"},actions:{LOGOUT({dispatch:e,commit:t}){t("UPLOAD_AREA_ACTIVE_LOGOUT"),e("DIR_IMAGE_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),e("USER_SETTINGS_LOGOUT"),e("TOOLBOX_IMG_LIST_RESET"),e("UPLOAD_IMG_LIST_RESET"),localStorage.clear(),sessionStorage.clear()}}}),Aa=Symbol("vuex-store");function Pa(){return y(Aa)}const $a=()=>{const{tokenCreateTime:e}=f((()=>Ca.getters.getGitHubAuthorizationInfo)).value;return Date.now()-e>432e6},Da=()=>{window.location.href="https://github.com/login/oauth/authorize?client_id=Iv1.274fe6f96551b91f&redirect_uri=https://picx.xpoet.cn"};var Ga,Ua;(Ua=Ga||(Ga={}))[Ua.installGitHubAppURL=0]="installGitHubAppURL",Ua[Ua.oauthLoginDocs=1]="oauthLoginDocs",Ua[Ua.generateTokenURL=2]="generateTokenURL",Ua[Ua.tokenLoginDocs=3]="tokenLoginDocs";var Ra=(e,t)=>{const a=e.__vccOpts||e;for(const[i,l]of t)a[i]=l;return a};const za={class:"page-container login-container"},Ma={class:"left-box box-item"},Na={class:"tips-box"},Ha={class:"tip-item"},ja={class:"right-box box-item"},Va={class:"tips-box"},Ba={class:"tip-item"};var Fa=Ra(w({__name:"picx-login",setup(e){const t=f((()=>Ca.getters.getGitHubAuthorizationInfo)).value,a=f((()=>Ca.getters.getUserConfigInfo)).value,i=x(!1),l=()=>{i.value=!0,Ca.dispatch("SET_GITHUB_AUTHORIZATION_INFO",{isAutoAuthorize:!0});const{authorized:e,installed:a,token:l}=t;e&&a&&l&&!$a()?(Ca.dispatch("SET_USER_CONFIG_INFO",{token:l}),Yo.push("/config")):Da()},s=()=>{const{manualToken:e}=t;Ca.dispatch("SET_GITHUB_AUTHORIZATION_INFO",{isAutoAuthorize:!1}),Ca.dispatch("SET_USER_CONFIG_INFO",{token:e}),Yo.push({path:"/config",query:{focus:"1"}})},c=e=>{let t="https://picx-docs.xpoet.cn";switch(e){case Ga.installGitHubAppURL:t="https://github.com/apps/picx-app/installations/select_target",a.id&&(t="https://github.com/apps/picx-app/installations/new/permissions?target_id="+a.id),window.location.href=t;break;case Ga.oauthLoginDocs:window.open(`${t}/docs/usage-guide/config.html#github-oauth-授权登录`);break;case Ga.generateTokenURL:window.open("https://github.com/settings/tokens/new");break;case Ga.tokenLoginDocs:window.open(`${t}/docs/usage-guide/config.html#填写-github-token-登录`);break;default:window.open(t)}};return I((()=>{(async()=>{var e;const t=new URLSearchParams(window.location.search),a=t.get("code"),i=t.get("setup_action"),l=t.get("installation_id");if("install"===i&&l&&!a&&(await Ca.dispatch("SET_GITHUB_AUTHORIZATION_INFO",{installed:!0,installationId:l}),v.confirm(ot.global.t("authorization.msg_3"),ot.global.t("tip"),{confirmButtonText:ot.global.t("confirm"),cancelButtonText:ot.global.t("cancel"),type:"success",draggable:!0}).then((()=>{Da()})).catch((()=>{window.location.href="/"}))),a){const t=m.service({lock:!0,text:ot.global.t("authorization.loading_1")});try{await Ca.dispatch("SET_GITHUB_AUTHORIZATION_INFO",{authorized:!0,code:a,codeCreateTime:Date.now(),isAutoAuthorize:!0});const{token:i}=f((()=>Ca.getters.getGitHubAuthorizationInfo)).value;let l="";if(!i||i&&$a()){const t=await d.get(`https://apis.xpoet.cn/api/github-authorize?code=${a}&redirect_uri=https://picx.xpoet.cn`);(null==(e=t.data)?void 0:e.data)?(l=t.data.data,await Ca.dispatch("SET_GITHUB_AUTHORIZATION_INFO",{token:l,tokenCreateTime:Date.now()})):u.error({message:t.data.msg,duration:6e3})}else l=i;if(l){await Ca.dispatch("SET_USER_CONFIG_INFO",{token:l}),t.close();const e=window.location.href.replace(window.location.search,"");window.location.href=`${e}config?auto=1`}t.close()}catch(s){t.close(),u.error({message:ot.global.t("authorization.msg_4"),duration:6e3})}}})(),(()=>{var e;const{token:t,name:i,owner:l,repo:s,branch:o,selectedDir:n,logined:r}=a;"0"!==(null==(e=Yo.currentRoute.value.query)?void 0:e.jump)&&t&&i&&l&&r&&(s&&o&&n?Yo.push("/upload"):Yo.push("/config"))})()})),S((()=>t.authorizing),(e=>{e&&(Ca.dispatch("SET_GITHUB_AUTHORIZATION_INFO",{authorizing:!1}),l())})),(e,a)=>{const d=k,u=We,m=T,g=Fe,p=je;return o(),n("div",za,[r("div",Ma,[L(d,{plain:"",type:"primary",onClick:l,size:"large",loading:i.value},{default:E((()=>[A(O(e.$t("authorization.text_1")),1)])),_:1},8,["loading"]),r("div",Na,[r("div",Ha,O(e.$t("authorization.text_8")),1),r("div",{class:"tip-item link",onClick:a[0]||(a[0]=e=>c(C(Ga).oauthLoginDocs))},[L(m,null,{default:E((()=>[L(u)])),_:1}),A(" "+O(e.$t("authorization.text_10")),1)]),r("div",{class:"tip-item link",onClick:a[1]||(a[1]=e=>c(C(Ga).installGitHubAppURL))},[L(m,null,{default:E((()=>[L(g)])),_:1}),A(" "+O(e.$t("authorization.text_11"))+" ",1),C(t).installed?(o(),P(m,{key:0,class:"install-status"},{default:E((()=>[L(p)])),_:1})):$("",!0)])])]),r("div",ja,[L(d,{plain:"",type:"primary",size:"large",onClick:s},{default:E((()=>[A(O(e.$t("authorization.text_2")),1)])),_:1}),r("div",Va,[r("div",Ba,O(e.$t("authorization.text_9")),1),r("div",{class:"tip-item link",onClick:a[2]||(a[2]=e=>c(C(Ga).tokenLoginDocs))},[L(m,null,{default:E((()=>[L(u)])),_:1}),A(" "+O(e.$t("authorization.text_10")),1)]),r("div",{class:"tip-item link",onClick:a[3]||(a[3]=e=>c(C(Ga).generateTokenURL))},[L(m,null,{default:E((()=>[L(g)])),_:1}),A(" "+O(e.$t("authorization.text_12")),1)])])])])}}}),[["__scopeId","data-v-2039bba2"]]);const Xa=f((()=>Ca.getters.getUserConfigInfo)).value,qa=f((()=>Ca.getters.getDeployStatusInfo)).value,Wa=async()=>{const{owner:e,repo:t,branch:a}=Xa;if(!e||!t||!a)return null;const i=await Mt({url:`/repos/${e}/${t}/contents/.deploy`,method:"GET",noShowErrMsg:!0,noCache:!0,params:{branch:a}});return Promise.resolve(i)},Ja=e=>{switch(e){case Ea.githubPages:return"GitHub Pages";case Ea.vervel:return"Vercel";default:return"GitHub Pages"}};const Ka={class:"deploy-status-bar-box border-box"},Za={class:"left-wrap flex-start"},Ya={key:0,class:"deploy-datetime info-item"},Qa={class:"deploy-server info-item"},ei={class:"deploy-status info-item"},ti={class:"right-wrap"};var ai=Ra(w({__name:"deploy-status-bar",props:{disabled:{type:Boolean,default:!1}},setup(e){const t=f((()=>Ca.getters.getUserSettings)).value,a=f((()=>Ca.getters.getUserConfigInfo)).value,i=f((()=>Ca.getters.getDeployStatusInfo)).value,l=e=>{switch(e.type){case Ea.githubPages:return void Vt(a,(e=>{i.github.status=e,i.github.latestTime=Date.now(),(async()=>{const{owner:e,repo:t,branch:a}=Xa,i=await Wa(),l={message:i?"Update deploy status via PicX (https://github.com/XPoet/picx)":"Init deploy status via PicX (https://github.com/XPoet/picx)",content:window.btoa(JSON.stringify(qa))};i?l.sha=i.sha:l.branch=a;const s=await Mt({url:`/repos/${e}/${t}/contents/.deploy`,method:"PUT",data:l,noShowErrMsg:!0});Promise.resolve(s)})(),e?(t.imageLinkType.selected=wt.GitHubPages,Ca.dispatch("USER_SETTINGS_PERSIST"),u.success(ot.global.t("settings_page.image_hosting_deploy.success"))):u.error(ot.global.t("settings_page.image_hosting_deploy.fail2"))}));case Ea.vervel:}};return(t,a)=>{const s=k;return o(),n("div",Ka,[(o(!0),n(D,null,G(C(i),((a,i)=>(o(),n("div",{class:"deploy-item status-bar info",key:i+a.uuid},[r("div",Za,[r("span",{class:U(["deploy-status-icon info-item",{success:!0===a.status,fail:!1===a.status}])},null,2),a.latestTime?(o(),n("span",Ya,O(C(mt)("yyyy-MM-dd hh:mm:ss",a.latestTime)),1)):$("",!0),r("span",Qa,O(C(Ja)(a.type)),1),r("span",ei,O(null===a.status?t.$t("settings_page.image_hosting_deploy.not_deployed"):!0===a.status?t.$t("settings_page.image_hosting_deploy.success"):t.$t("settings_page.image_hosting_deploy.fail")),1)]),r("div",ti,[L(s,{type:"primary",disabled:e.disabled,text:"",onClick:e=>l(a)},{default:E((()=>[A(O(t.$t("settings_page.image_hosting_deploy.one_click_deploy")),1)])),_:2},1032,["disabled","onClick"])])])))),128))])}}}),[["__scopeId","data-v-045d61c6"]]);const ii={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},li=[r("path",{fill:"currentColor",d:"M544 864V672h128L512 480L352 672h128v192H320v-1.6c-5.376.32-10.496 1.6-16 1.6A240 240 0 0 1 64 624c0-123.136 93.12-223.488 212.608-237.248A239.81 239.81 0 0 1 512 192a239.87 239.87 0 0 1 235.456 194.752c119.488 13.76 212.48 114.112 212.48 237.248a240 240 0 0 1-240 240c-5.376 0-10.56-1.28-16-1.6v1.6z"},null,-1)];var si={name:"ep-upload-filled",render:function(e,t){return o(),n("svg",ii,[...li])}};const oi=(e=>(M("data-v-3c85bfcd"),e=e(),N(),e))((()=>r("label",{for:"input-file-selector"},null,-1))),ni={key:0,class:"upload-area-tips"},ri={class:"text"},ci=["src"];var di=Ra(w({__name:"getting-images",props:{disabled:{type:Boolean,default:!1}},emits:["getImgList"],setup(e,{expose:t,emit:a}){const i=Pa(),l=f((()=>i.getters.getUploadAreaState)),s=x({uuid:"",base64:""}),c=x([]),d=a,u=()=>{const e=c.value.length,t=e>0?c.value[e-1]:{uuid:"",base64:""};s.value={uuid:t.uuid,base64:t.base64}},m=async e=>{if(e.length){c.value=[];for(const t of e){const e=await la(t);e&&c.value.push(e)}u(),i.commit("SET_UPLOAD_AREA_STATE",{isActive:!0}),d("getImgList",c.value)}},g=async e=>{const t=e.target;await m(t.files),t.value="",t.value=t.defaultValue},p=async e=>{await m(e.dataTransfer.files)},_=async e=>{const t=Array.from(e.clipboardData.items).filter((e=>"file"===e.kind&&aa(e.type))).map((e=>e.getAsFile()));await m(t)};return I((()=>{window.addEventListener("paste",_)})),R((()=>{window.removeEventListener("paste",_)})),t({reset:()=>{c.value=[],s.value.uuid="",s.value.base64=""},remove:e=>{const t=c.value.findIndex((t=>t.uuid===e));-1!==t&&c.value.splice(t,1),e===s.value.uuid&&u()}}),(t,a)=>{const i=si,c=T;return o(),n("div",{class:U(["getting-images-container",{focus:l.value.isActive&&s.value.base64,disabled:e.disabled}]),onDragover:a[0]||(a[0]=z((()=>{}),["prevent"])),onDrop:z(p,["stop","prevent"]),onPaste:z(_,["stop"])},[oi,r("input",{id:"input-file-selector",type:"file",accept:"image/*",onChange:g,multiple:"multiple"},null,32),s.value.base64?$("",!0):(o(),n("div",ni,[L(c,{class:"icon"},{default:E((()=>[L(i)])),_:1}),r("div",ri,O(t.$t("upload_page.upload_area_text")),1)])),s.value.base64?(o(),n("img",{key:1,class:"preview-img",src:s.value.base64},null,8,ci)):$("",!0)],34)}}}),[["__scopeId","data-v-3c85bfcd"]]);const ui=f((()=>Ca.getters.getUserSettings)).value,mi=(e,t,a)=>{var i;let l=a.selectedDir;(null==(i=null==t?void 0:t.reUploadInfo)?void 0:i.isReUpload)&&(l=t.reUploadInfo.dir),t.uploadStatus.progress=100,t.uploadStatus.uploading=!1;const s={checked:!1,type:"image",uuid:t.uuid,dir:l,name:e.name,sha:e.sha,path:e.path,deleting:!1,size:e.size,deployed:!0};t.uploadedImg=s,Ca.dispatch("DIR_IMAGE_LIST_ADD_DIR",l),Ca.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",s)};function gi(e,t){const{branch:a,email:i,owner:l}=e,s={message:"Upload image via PicX (https://github.com/XPoet/picx)",branch:a,content:(t.base64.compressBase64||t.base64.watermarkBase64||t.base64.originalBase64).split(",")[1]};return i&&(s.committer={name:l,email:i}),t.uploadStatus.uploading=!0,new Promise((async a=>{const i=await((e,t)=>Mt({url:e,method:"PUT",data:t}))(((e,t)=>{var a;const{owner:i,repo:l,selectedDir:s}=e,o=t.filename.final;let n=o;return"/"!==s&&(n=`${s}/${o}`),(null==(a=null==t?void 0:t.reUploadInfo)?void 0:a.isReUpload)&&(n=t.reUploadInfo.path),`/repos/${i}/${l}/contents/${n}`})(e,t),s);if(t.uploadStatus.uploading=!1,i){const{name:l,sha:s,path:o,size:n}=i.content;mi({name:l,sha:s,path:o,size:n},t,e),a(!0)}else a(!1)}))}const pi={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},_i=[r("path",{fill:"currentColor",d:"M406.656 706.944L195.84 496.256a32 32 0 1 0-45.248 45.248l256 256l512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"},null,-1)];var hi={name:"ep-check",render:function(e,t){return o(),n("svg",pi,[..._i])}};const fi={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},vi=[r("path",{fill:"currentColor",d:"M160 832h704a32 32 0 1 1 0 64H160a32 32 0 1 1 0-64m384-578.304V704h-64V247.296L237.248 490.048L192 444.8L508.8 128l316.8 316.8l-45.312 45.248z"},null,-1)];var bi={name:"ep-upload",render:function(e,t){return o(),n("svg",fi,[...vi])}};const yi={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},wi=[r("path",{fill:"currentColor",d:"M352 480h320a32 32 0 1 1 0 64H352a32 32 0 0 1 0-64"},null,-1),r("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768a384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896a448 448 0 0 1 0 896"},null,-1)];var xi={name:"ep-remove",render:function(e,t){return o(),n("svg",yi,[...wi])}};const Ii={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Si=[r("path",{fill:"currentColor",d:"M672 192L288 511.936L672 832z"},null,-1)];var ki={name:"ep-caret-left",render:function(e,t){return o(),n("svg",Ii,[...Si])}};const Ti={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Li=[r("path",{fill:"currentColor",d:"m192 384l320 384l320-384z"},null,-1)];var Ei={name:"ep-caret-bottom",render:function(e,t){return o(),n("svg",Ti,[...Li])}};const Oi=(e,t)=>{t.filename.isAddPrefix=e,t.filename.name=e?`${t.filename.prefix}${t.filename.initName}`:`${t.filename.initName}`,t.filename.isAddHash?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`},Ci=(e,t)=>{t.filename.isAddHash=e,t.filename.final=e?`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:`${t.filename.name}.${t.filename.suffix}`};const Ai=["element-loading-text"],Pi={class:"before-upload-handle-container"},$i={class:"img-name text-ellipsis"},Di={class:"operate-item"},Gi={class:"operate-item"},Ui={key:0,class:"operate-item"},Ri={key:1,class:"img-info-box"},zi={class:"file-size-box"},Mi={key:0,class:"finial-file-size file-size-item"},Ni={class:"last-modified"};var Hi=Ra(w({__name:"upload-image-card",props:{imgObj:{type:Object,require:!0,default:()=>({})}},emits:["remove"],setup(e,{emit:t}){const a=Pa(),i=J(),l=e,s=t,c=f((()=>a.getters.getUserSettings)).value,d=x(null),u=x(""),m=j({isAddHash:!1,isAddPrefix:!1,isRename:!1,newName:""}),g=x(!0),p=()=>{var e,t;l.imgObj.filename.newName=m.newName,setTimeout((()=>{var e;null==(e=d.value)||e.focus()}),100),e=m.isRename,(t=l.imgObj).filename.isRename=e,e?t.filename.name=t.filename.newName.trim().replace(/\s+/g,"-"):Oi(t.filename.isAddPrefix,t),t.filename.isAddHash?t.filename.final=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.final=`${t.filename.name}.${t.filename.suffix}`};return S((()=>l.imgObj.uploadStatus),(e=>{e.uploading&&(u.value=i.proxy.$t("upload_page.uploading"))}),{deep:!0,immediate:!0}),I((async()=>{await(async(e,t)=>{const{watermark:a,compress:i}=t;let l=e.fileInfo.originalFile;var s;a.enable&&a.text&&!e.fileInfo.watermarkFile&&(e.beforeUploadStatus.watermarking=!0,e.fileInfo.watermarkFile=(s=(s=e.fileInfo.originalFile.type).toLowerCase(),/(png|jpg|jpeg|webp|avif)$/.test(s)?await $t(e.fileInfo.originalFile,a):e.fileInfo.originalFile),l=e.fileInfo.watermarkFile,e.base64.watermarkBase64=await Qt(l),e.beforeUploadStatus.watermarking=!1),i.enable&&!e.fileInfo.compressFile&&(e.beforeUploadStatus.compressing=!0,e.fileInfo.compressFile=await sa(l,i.encoder),l=e.fileInfo.compressFile,e.base64.compressBase64=await Qt(l),e.filename.suffix=ta(l.name),e.beforeUploadStatus.compressing=!1)})(l.imgObj,c),(()=>{const{imageName:e}=c;0===l.imgObj.uploadStatus.progress&&(l.imgObj.filename.isAddHash=e.enableHash,l.imgObj.filename.isAddPrefix=e.addPrefix.enable,l.imgObj.filename.prefix=e.addPrefix.prefix,Oi(e.addPrefix.enable,l.imgObj),Ci(e.enableHash,l.imgObj),m.isAddHash=l.imgObj.filename.isAddHash,m.isAddPrefix=l.imgObj.filename.isAddPrefix,m.isRename=l.imgObj.filename.isRename,m.newName=l.imgObj.filename.newName)})()})),(t,a)=>{var i,_,h,f,v,b,y,w;const x=V,I=Ei,S=ki,k=T,A=B,D=F,G=X,R=xi,z=bi,M=hi,N=q;return o(),n("div",{class:U(["upload-image-card-container",{"wait-upload":!e.imgObj.uploadStatus.uploading&&0===e.imgObj.uploadStatus.progress,uploading:e.imgObj.uploadStatus.uploading&&100!==e.imgObj.uploadStatus.progress,uploaded:!e.imgObj.uploadStatus.uploading&&100===e.imgObj.uploadStatus.progress}])},[W((o(),n("div",{class:"img-show-container","element-loading-text":u.value},[L(x,{src:e.imgObj.base64.compressBase64||e.imgObj.base64.watermarkBase64||e.imgObj.base64.originalBase64,fit:"cover",loading:"lazy","hide-on-click-modal":!0,"preview-src-list":[e.imgObj.base64.compressBase64||e.imgObj.base64.watermarkBase64||e.imgObj.base64.originalBase64]},null,8,["src","preview-src-list"])],8,Ai)),[[N,e.imgObj.uploadStatus.uploading||e.imgObj.beforeUploadStatus.compressing||e.imgObj.beforeUploadStatus.watermarking]]),r("div",Pi,[r("div",{class:U(["img-name-box",{"no-border":100===e.imgObj.uploadStatus.progress}])},[r("span",$i,O(e.imgObj.filename.final||e.imgObj.filename.name),1),0===e.imgObj.uploadStatus.progress?(o(),P(A,{key:0,placement:"top",offset:8,content:g.value?t.$t("upload_page.expand"):t.$t("upload_page.fold")},{default:E((()=>[L(k,{class:"fold-btn",onClick:a[0]||(a[0]=e=>g.value=!g.value)},{default:E((()=>[g.value?$("",!0):(o(),P(I,{key:0})),g.value?(o(),P(S,{key:1})):$("",!0)])),_:1})])),_:1},8,["content"])):$("",!0)],2),0===e.imgObj.uploadStatus.progress?(o(),n("div",{key:0,class:U(["img-name-operate-box",{folded:g.value}])},[r("div",Di,[L(D,{label:t.$t("upload_page.add_hash"),modelValue:m.isAddHash,"onUpdate:modelValue":a[1]||(a[1]=e=>m.isAddHash=e),onChange:a[2]||(a[2]=e=>{Ci(e,l.imgObj)})},null,8,["label","modelValue"])]),r("div",Gi,[L(D,{label:t.$t("rename"),modelValue:m.isRename,"onUpdate:modelValue":a[3]||(a[3]=e=>m.isRename=e),onChange:p},null,8,["label","modelValue"]),e.imgObj.filename.isRename?(o(),P(G,{key:0,class:"rename-input",size:"small",modelValue:m.newName,"onUpdate:modelValue":a[4]||(a[4]=e=>m.newName=e),onInput:p,maxlength:C(18),ref_key:"renameInputRef",ref:d,clearable:""},null,8,["modelValue","maxlength"])):$("",!0)]),!e.imgObj.filename.isRename&&C(c).imageName.addPrefix.enable&&C(c).imageName.addPrefix.prefix?(o(),n("div",Ui,[L(D,{label:t.$t("upload_page.add_prefix"),modelValue:m.isAddPrefix,"onUpdate:modelValue":a[5]||(a[5]=e=>m.isAddPrefix=e),onChange:a[6]||(a[6]=e=>{Oi(e,l.imgObj)})},null,8,["label","modelValue"])])):$("",!0)],2)):$("",!0),0===e.imgObj.uploadStatus.progress?(o(),n("div",Ri,[r("div",zi,[r("span",{class:U(["original-file-size file-size-item",{"del-line":null==(_=null==(i=e.imgObj.fileInfo)?void 0:i.compressFile)?void 0:_.size}])},O(C(ia)(null==(h=e.imgObj.fileInfo.originalFile)?void 0:h.size))+" KB ",3),(null==(v=null==(f=e.imgObj.fileInfo)?void 0:f.compressFile)?void 0:v.size)?(o(),n("span",Mi,O(C(ia)(null==(y=null==(b=e.imgObj.fileInfo)?void 0:b.compressFile)?void 0:y.size))+" KB ",1)):$("",!0)]),r("span",Ni,O(C(mt)("yyyy-MM-dd hh:mm",null==(w=e.imgObj.fileInfo.originalFile)?void 0:w.lastModified)),1)])):$("",!0)]),100===e.imgObj.uploadStatus.progress?(o(),n("div",{key:0,class:"after-upload-handle-container flex-center",onClick:a[7]||(a[7]=t=>C(ca)(e.imgObj.uploadedImg))},O(t.$t("copy_link")),1)):$("",!0),0===e.imgObj.uploadStatus.progress?(o(),P(A,{key:1,placement:"top",offset:8,content:t.$t("delete")},{default:E((()=>[L(k,{class:"del-img-btn",onClick:a[8]||(a[8]=t=>{return a=e.imgObj.uuid,void s("remove",a);var a})},{default:E((()=>[L(R)])),_:1})])),_:1},8,["content"])):$("",!0),r("div",{class:U(["upload-status-box",{"wait-upload":!e.imgObj.uploadStatus.uploading&&0===e.imgObj.uploadStatus.progress,uploaded:!e.imgObj.uploadStatus.uploading&&100===e.imgObj.uploadStatus.progress}])},[L(k,null,{default:E((()=>[e.imgObj.uploadStatus.uploading||0!==e.imgObj.uploadStatus.progress?$("",!0):(o(),P(z,{key:0})),e.imgObj.uploadStatus.uploading||100!==e.imgObj.uploadStatus.progress?$("",!0):(o(),P(M,{key:1}))])),_:1})],2)],2)}}}),[["__scopeId","data-v-70a9b57f"]]);const ji=w({__name:"repo-dir-cascader",props:{elKey:{type:String,default:""},elSize:{type:String,default:kt.default},elWidth:{type:String,default:"100%"},elClearable:{type:Boolean,default:!1}},setup(e){const t=Pa(),a=f((()=>t.getters.getUserConfigInfo)).value,i={lazy:!0,checkStrictly:!0,async lazyLoad(e,t){const{level:i,pathLabels:l}=e;let s;s=0===i?a.dirList:await Nt(a,l.join("/")),s.length?t(s.map((e=>({value:e.value,label:e.label,leaf:i>=4})))):t([])}},l=e=>{Array.isArray(e)&&e.length?(a.selectedDirList=e,a.selectedDir=e.join("/")):(a.selectedDirList=[],a.selectedDir=""),t.dispatch("USER_CONFIG_INFO_PERSIST")};return(t,s)=>{const n=K;return o(),P(n,{style:Z({width:e.elWidth}),size:e.elSize,debounce:500,props:i,key:e.elKey,modelValue:C(a).selectedDirList,"onUpdate:modelValue":s[0]||(s[0]=e=>C(a).selectedDirList=e),filterable:"",placeholder:t.$t("config_page.placeholder_5"),clearable:e.elClearable,onChange:l},null,8,["style","size","modelValue","placeholder","clearable"])}}}),Vi={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Bi=[r("path",{fill:"currentColor",d:"M128 192v640h768V320H485.76L357.504 192zm-32-64h287.872l128.384 128H928a32 32 0 0 1 32 32v576a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32"},null,-1)];var Fi={name:"ep-folder",render:function(e,t){return o(),n("svg",Vi,[...Bi])}};const Xi={key:0,class:"dir-info-bar border-box"};var qi=Ra(w({__name:"dir-info-bar",setup(e){const t=Pa(),a=f((()=>t.getters.getUserConfigInfo)),i=f((()=>t.getters.getGlobalSettings)),l=()=>{Yo.push("/config")};return(e,t)=>{const s=Fi,c=T,d=ji,u=Y;return a.value.repo&&a.value.branch?(o(),n("div",Xi,[r("div",{class:"dir-name",onClick:l},[L(c,null,{default:E((()=>[L(s)])),_:1}),A(" "+O(e.$t("dir")),1)]),a.value.dirMode===C(It).repoDir?(o(),P(d,{key:0,"el-size":i.value.elementPlusSize===C(kt).large?C(kt).default:i.value.elementPlusSize,"el-clearable":!1},null,8,["el-size"])):(o(),P(u,{key:1,"disable-transitions":""},{default:E((()=>[A(O(a.value.selectedDir),1)])),_:1}))])):$("",!0)}}}),[["__scopeId","data-v-46ce022c"]]);const Wi={class:"upload-page-container"},Ji={key:0,class:"upload-page-left page-container"},Ki={class:"row-item"},Zi={class:"content-box"},Yi={class:"row-item"},Qi={class:"content-box upload-area-status"},el={key:0,class:"upload-count"},tl={key:0,class:"row-item"},al={class:"content-box"},il={key:1,class:"row-item"},ll={class:"content-box operation-btn"},sl={class:"shortcut-key"},ol={class:"shortcut-key"},nl=w({__name:"upload-image",setup(e){const t=J(),a=x(null),i=f((()=>Ca.getters.getUserConfigInfo)).value,l=f((()=>Ca.getters.getGlobalSettings)).value,c=f((()=>Ca.getters.getUserLoginStatus)),d=x([]),m=x(!1),g=f((()=>"mac"===ua()?"⌘":"Ctrl")),p=x(!1),_=e=>{e.forEach((e=>{Ca.dispatch("UPLOAD_IMG_LIST_ADD",(e=>{const t={uuid:"",base64:{originalBase64:"",watermarkBase64:null,compressBase64:null},fileInfo:{originalFile:null,watermarkFile:null,compressFile:null},filename:{hash:"",suffix:"",name:"",prefix:"",final:"",initName:"",newName:"",isAddHash:!0,isRename:!1,isAddPrefix:!1},beforeUploadStatus:{watermarking:!1,compressing:!1},uploadStatus:{progress:0,uploading:!1},reUploadInfo:{dir:"",path:"",isReUpload:!1}};t.uuid=e.uuid,t.base64.originalBase64=e.base64,t.fileInfo.originalFile=e.file;const{imageName:a}=ui,i=e.uuid,l=e.file.name.trim().replaceAll(" ","-"),s=l.lastIndexOf(".");let o=l.slice(0,s);o=a.enableMD5?H.hashStr(o):o;const n=l.slice(s+1);return t.filename.initName=o,t.filename.name=a.addPrefix.enable?`${a.addPrefix.prefix}${o}`:o,t.filename.prefix=a.addPrefix.prefix,t.filename.hash=i,t.filename.suffix=n,t.filename.final=a.enableHash?`${t.filename.name}.${i}.${n}`:`${t.filename.name}.${n}`,t.filename.isAddHash=a.enableHash,t.filename.isAddPrefix=a.addPrefix.enable,t})(e))}))},h=()=>{var e;null==(e=a.value)||e.reset()},v=async e=>1===e.length?await gi(i,e[0])?_t.uploaded:_t.uploadFail:e.length>1?await async function(e,t){const{branch:a,repo:i,selectedDir:l,owner:o}=e,n=[];for(const g of t){g.uploadStatus.uploading=!0;const e=(g.base64.compressBase64||g.base64.watermarkBase64||g.base64.originalBase64).split(",")[1],t=await Ft(e,o,i);t?n.push(s({img:g},t)):(g.uploadStatus.uploading=!1,u.error(ot.global.t("upload_page.tip_11",{name:g.filename.final})))}const r=await jt(o,i,a);if(!r)return Promise.resolve(!1);const c="/"===l?"":`${l}/`,d=await Xt(o,i,n.map((e=>({sha:e.sha,path:`${c}${e.img.filename.final}`}))),r);if(!d)return Promise.resolve(!1);const m=await qt(o,i,d,r);return m&&await Wt(o,i,a,m.sha)?(n.forEach((t=>{const a=t.img.filename.final;mi({name:a,sha:t.sha,path:`${c}${a}`,size:0},t.img,e)})),Promise.resolve(!0)):Promise.resolve(!1)}(i,e)?_t.allUploaded:_t.uploadFail:void 0,b=async(e,t=!1)=>{h(),t?da(e,!0):ca(e[0],!0),await Ca.dispatch("SET_USER_CONFIG_INFO",{viewDir:i.selectedDir})},y=async()=>{var e,a,l,s,o,n,r;const{token:c,repo:g,selectedDir:p}=i;if(!c)return u.error({message:null==(e=null==t?void 0:t.proxy)?void 0:e.$t("upload_page.message1")}),void(await Yo.push("/config"));if(!g)return u.error({message:null==(a=null==t?void 0:t.proxy)?void 0:a.$t("upload_page.message2")}),void(await Yo.push("/config"));if(!p)return u.error({message:null==(l=null==t?void 0:t.proxy)?void 0:l.$t("upload_page.message3")}),void(await Yo.push("/config"));const _=d.value.filter((e=>0===e.uploadStatus.progress));if(0===_.length)return void u.error({message:null==(s=null==t?void 0:t.proxy)?void 0:s.$t("upload_page.message4")});m.value=!0;const h=await v(_);m.value=!1;const f=_.filter((e=>100===e.uploadStatus.progress)).map((e=>e.uploadedImg));switch(h){case _t.uploaded:u.success({message:null==(o=null==t?void 0:t.proxy)?void 0:o.$t("upload_page.message5")}),await b(f);break;case _t.allUploaded:u.success({message:null==(n=null==t?void 0:t.proxy)?void 0:n.$t("upload_page.message6")}),await b(f,!0);break;case _t.uploadFail:u.error({message:null==(r=null==t?void 0:t.proxy)?void 0:r.$t("upload_page.message7")})}},w=()=>{m.value=!1,p.value=!1,Ca.dispatch("UPLOAD_IMG_LIST_RESET"),h()};S((()=>c),(e=>{!e&&w()})),S((()=>Ca.state.uploadImageListModule.uploadImageList),(e=>{d.value=e,p.value=d.value.some((e=>100===e.uploadStatus.progress))}),{immediate:!0,deep:!0});return I((()=>{document.addEventListener("keydown",(e=>{const t=e.keyCode||e.which||e.charCode,a=e.ctrlKey||e.metaKey;a&&65===t&&d.value.length&&(w(),e.preventDefault()),a&&83===t&&(m.value||(y(),e.preventDefault()))}))})),(e,t)=>{const s=di,c=ai,u=k;return o(),n("div",Wi,[d.value.length&&C(l).elementPlusSize!==C(kt).small?(o(),n("div",Ji,[(o(!0),n(D,null,G(d.value,((e,i)=>(o(),n("div",{class:"uploaded-item",key:i+e.uuid},[L(Hi,{"img-obj":e,onRemove:t[0]||(t[0]=e=>{return t=e,Ca.dispatch("UPLOAD_IMG_LIST_REMOVE",t),void(null==(i=a.value)||i.remove(t));var t,i})},null,8,["img-obj"])])))),128))])):$("",!0),r("div",{class:U(["upload-page-right page-container",{"has-left":d.value.length}])},[r("div",Ki,[r("div",Zi,[L(s,{disabled:m.value,ref_key:"gettingImagesRef",ref:a,onGetImgList:_},null,8,["disabled"])])]),r("div",Yi,[r("div",Qi,[L(qi),d.value.length?(o(),n("span",el,O(e.$t("uploaded"))+"："+O(d.value.filter((e=>100===e.uploadStatus.progress)).length)+" / "+O(d.value.length),1)):$("",!0)])]),C(i).logined?(o(),n("div",tl,[r("div",al,[L(c,{disabled:!p.value},null,8,["disabled"])])])):$("",!0),d.value.length?(o(),n("div",il,[r("div",ll,[L(u,{disabled:m.value,plain:"",type:"warning",onClick:w},{default:E((()=>[A(O(e.$t("reset"))+" ",1),r("span",sl,O(g.value)+" A",1)])),_:1},8,["disabled"]),L(u,{disabled:m.value,plain:"",type:"primary",onClick:y},{default:E((()=>[A(O(e.$t("upload"))+" ",1),r("span",ol,O(g.value)+" S",1)])),_:1},8,["disabled"])])])):$("",!0)],2)])}}});var rl,cl;(cl=rl||(rl={}))[cl.dirArea=0]="dirArea",cl[cl.dir=1]="dir",cl[cl.img=2]="img",cl[cl.uploadArea=3]="uploadArea";const dl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ul=[r("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"},null,-1)];var ml={name:"ep-delete",render:function(e,t){return o(),n("svg",dl,[...ul])}};const gl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},pl=[r("path",{fill:"currentColor",d:"M768 832a128 128 0 0 1-128 128H192A128 128 0 0 1 64 832V384a128 128 0 0 1 128-128v64a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64z"},null,-1),r("path",{fill:"currentColor",d:"M384 128a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64zm0-64h448a128 128 0 0 1 128 128v448a128 128 0 0 1-128 128H384a128 128 0 0 1-128-128V192A128 128 0 0 1 384 64"},null,-1)];var _l={name:"ep-copy-document",render:function(e,t){return o(),n("svg",gl,[...pl])}};const hl={key:0,class:"selector-wrapper"},fl={class:"selector-left-box"},vl={class:"item"},bl={class:"selector-right-box"};var yl=Ra(w({__name:"image-selector",props:{currentDirImageList:{type:Array,default:()=>[]}},emits:["updateInitImageList"],setup(e){const t=e,a=Pa(),i=x(!1),l=J(),s=f((()=>a.getters.getImageCardCheckedArr)),c=f((()=>a.getters.getUserConfigInfo)).value,d=f((()=>s.value.length||0));S((()=>d.value),(e=>{const a=t.currentDirImageList.length;i.value=e===a}));const m=()=>{da(s.value)},g=()=>{t.currentDirImageList.forEach((e=>{e.checked&&(e.checked=!1)}))},p=()=>{var e,t,a,i;(null==(e=s.value)?void 0:e.length)>0&&v.confirm(null==(a=null==l?void 0:l.proxy)?void 0:a.$t("management_page.delTips2",{total:null==(t=s.value)?void 0:t.length}),null==(i=null==l?void 0:l.proxy)?void 0:i.$t("tip"),{type:"warning"}).then((async()=>{var e,t,a;const i=await Zt(s.value,c);i===ft.deleted&&u.success({message:null==(e=null==l?void 0:l.proxy)?void 0:e.$t("management_page.message5")}),i===ft.allDeleted&&u.success({message:null==(t=null==l?void 0:l.proxy)?void 0:t.$t("management_page.message6")}),i===ft.deleteFail&&u.error({message:null==(a=null==l?void 0:l.proxy)?void 0:a.$t("management_page.message7")})})).catch((()=>{}))},_=()=>{let e=[];t.currentDirImageList.forEach((e=>{e.checked=i.value})),e=t.currentDirImageList,a.commit("REPLACE_IMAGE_CARD",{checkedImgArr:e})};return I((()=>{_()})),(e,t)=>{const a=F,l=_l,s=T,c=B,u=ml;return d.value?(o(),n("div",hl,[r("div",fl,[L(a,{label:i.value?e.$t("management_page.deselectAll"):e.$t("management_page.selectAll"),modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e),onChange:_},null,8,["label","modelValue"]),r("div",vl,O(e.$t("management_page.selectTotal",{total:d.value})),1),r("div",{class:"item cancel-select-btn",onClick:g},O(e.$t("management_page.unselect")),1)]),r("div",bl,[L(c,{placement:"top",content:e.$t("management_page.batchCopy"),"show-arrow":!1,offset:6},{default:E((()=>[L(s,{class:"btn-icon",onClick:m},{default:E((()=>[L(l)])),_:1})])),_:1},8,["content"]),L(c,{placement:"top",content:e.$t("management_page.batchDelete"),"show-arrow":!1,offset:6},{default:E((()=>[L(s,{class:"btn-icon",onClick:p},{default:E((()=>[L(u)])),_:1})])),_:1},8,["content"])])])):$("",!0)}}}),[["__scopeId","data-v-e8fb5f2c"]]);const wl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},xl=[r("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"},null,-1)];var Il={name:"ep-refresh",render:function(e,t){return o(),n("svg",wl,[...xl])}};const Sl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},kl=[r("path",{fill:"currentColor",d:"M128 320v576h576V320zm-32-64h640a32 32 0 0 1 32 32v640a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V288a32 32 0 0 1 32-32M960 96v704a32 32 0 0 1-32 32h-96v-64h64V128H384v64h-64V96a32 32 0 0 1 32-32h576a32 32 0 0 1 32 32M256 672h320v64H256zm0-192h320v64H256z"},null,-1)];var Tl={name:"ep-document-copy",render:function(e,t){return o(),n("svg",Sl,[...kl])}};let Ll=0,El=0;const Ol=[],Cl=async(e,t,a,i)=>{const{owner:l}=f((()=>Ca.getters.getUserConfigInfo)).value,s=await Mt({method:"GET",noShowErrMsg:!0,url:`repos/${l}/${e}/contents/${a}`,params:{ref:t}});if(Ll+=1,s){if(Array.isArray(s)&&s.length){El+=s.length;for(const a of s)await Cl(e,t,a.path)}if("dir"===(null==s?void 0:s.type)&&await Cl(e,t,s.path),"file"===(null==s?void 0:s.type)&&aa(s.name)){let e=null==s?void 0:s.content;if(!e){const t=await Yt(s.download_url,ta(s.name)),a=null==t?void 0:t.split(",")[1];a&&(e=a)}Ol.push({name:s.name,path:s.path,content:e,sha:s.sha,download_url:s.download_url})}Ll>El&&i&&i({status:!0,imgList:Ol})}else i&&i({status:!1,imgList:Ol})};const Al={class:"copy-source-repo border-box"};var Pl=Ra(w({__name:"copy-source-repo",props:{position:{type:String,default:"config"}},setup(e){const t=x(!1),a=x(),i=x(),l=x(),c=x(!1),d=j({status:!1,text:""}),m=j({repo:"",branch:""}),g=()=>{var e,t,a;m.repo?m.branch?null==(a=i.value)||a.focus():null==(t=l.value)||t.focus():null==(e=i.value)||e.focus()},p=async()=>{a.value.validate((async e=>{e?(c.value=!0,await Cl(m.repo,m.branch,"",(async({status:e,imgList:t})=>{if(e){const e=await(async(e,t)=>{const{branch:a,repo:i,owner:l}=f((()=>Ca.getters.getUserConfigInfo)).value,o=[];for(const d of e){const e=await Ft(d.content,l,i);e?o.push(s({img:d},e)):u.error(ot.global.t("upload_page.tip_11",{name:d.name}))}const n=await jt(l,i,a);if(!n)return Promise.resolve(!1);const r=await Xt(l,i,o.map((e=>({sha:e.sha,path:e.img.path}))),n);if(!r)return Promise.resolve(!1);const c=await qt(l,i,r,n,`Copy \`${t}\` image${e.length?"s":""} via PicX (https://github.com/XPoet/picx)`);return c&&await Wt(l,i,a,c.sha)?Promise.resolve(!0):Promise.resolve(!1)})(t,m.repo);c.value=!1,e?(d.status=!0,d.text=ot.global.t("copy_repo_img.text_6",{repo:m.repo}),await(async()=>{const e=f((()=>Ca.getters.getUserConfigInfo)).value;await Ca.dispatch("SET_USER_CONFIG_INFO",{viewDir:"/"}),await Ca.dispatch("DIR_IMAGE_LIST_INIT_DIR","/"),await Ht(e,"/")})()):(d.status=!1,d.text=ot.global.t("copy_repo_img.text_7",{repo:m.repo}))}else c.value=!1,d.status=!1,d.text=ot.global.t("copy_repo_img.text_4"),g()}))):g()}))},_=()=>{var e;d.status=!1,d.text="",null==(e=a.value)||e.clearValidate()};return S((()=>m),(()=>{d.status=!1,d.text=""}),{deep:!0}),S((()=>t.value),(e=>{e&&setTimeout((()=>{g()}),100)}),{immediate:!0}),(s,u)=>{const g=Tl,h=T,f=B,v=Q,b=ee,y=X,w=te,x=ae,I=k,S=ie;return o(),n(D,null,[L(f,{placement:"top",disabled:"management"!==e.position,content:s.$t("copy_repo_img.text_8"),"show-arrow":!1,offset:6},{default:E((()=>[L(h,{class:U(["copy-source-repo-icon",[e.position]]),onClick:u[0]||(u[0]=e=>t.value=!0)},{default:E((()=>[L(g)])),_:1},8,["class"])])),_:1},8,["disabled","content"]),L(S,{modelValue:t.value,"onUpdate:modelValue":u[4]||(u[4]=e=>t.value=e),width:"500",title:s.$t("copy_repo_img.text_1"),draggable:"","show-close":!c.value,"close-on-click-modal":!c.value,onClose:_},{footer:E((()=>[c.value?$("",!0):(o(),P(I,{key:0,onClick:u[3]||(u[3]=e=>t.value=!1)},{default:E((()=>[A(O(s.$t("cancel")),1)])),_:1})),L(I,{type:"primary",onClick:p,loading:c.value,disabled:d.status},{default:E((()=>[A(O(c.value?s.$t("copy_repo_img.loading_1"):s.$t("confirm")),1)])),_:1},8,["loading","disabled"])])),default:E((()=>[r("div",Al,[d.text?(o(),P(v,{key:0,class:"copy-result-tip",title:d.text,type:d.status?"success":"error","show-icon":"",closable:!1},null,8,["title","type"])):$("",!0),c.value?(o(),P(b,{key:1,class:"copy-progress","stroke-width":6,percentage:50,duration:2,indeterminate:!0,"show-text":!1})):$("",!0),L(x,{ref_key:"formRef",ref:a,"label-width":"90","label-position":"left",model:m,disabled:c.value},{default:E((()=>[L(w,{label:s.$t("repo"),prop:"repo",rules:[{required:!0,message:s.$t("copy_repo_img.text_2")}]},{default:E((()=>[L(y,{ref_key:"sourceRepoRef",ref:i,modelValue:m.repo,"onUpdate:modelValue":u[1]||(u[1]=e=>m.repo=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label","rules"]),L(w,{label:s.$t("branch"),prop:"branch",rules:[{required:!0,message:s.$t("copy_repo_img.text_3")}]},{default:E((()=>[L(y,{ref_key:"sourceRepoBranchRef",ref:l,modelValue:m.branch,"onUpdate:modelValue":u[2]||(u[2]=e=>m.branch=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label","rules"])])),_:1},8,["model","disabled"])])])),_:1},8,["modelValue","title","show-close","close-on-click-modal"])],64)}}}),[["__scopeId","data-v-642e5961"]]);const $l={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Dl=[r("path",{fill:"currentColor",d:"M685.248 104.704a64 64 0 0 1 0 90.496L368.448 512l316.8 316.8a64 64 0 0 1-90.496 90.496L232.704 557.248a64 64 0 0 1 0-90.496l362.048-362.048a64 64 0 0 1 90.496 0"},null,-1)];var Gl={name:"ep-arrow-left-bold",render:function(e,t){return o(),n("svg",$l,[...Dl])}};const Ul={class:"tools-bar border-box"},Rl={class:"left flex-start"},zl={class:"dir-info flex-start"},Ml={class:"right flex-end"};var Nl=Ra(w({__name:"tools-bar",emits:["reload"],setup(e,{emit:t}){const a=t,i=f((()=>Ca.getters.getUserConfigInfo)).value,l=()=>{const e=i.viewDir;if("/"===e)return;const t=e.split("/");1===t.length?i.viewDir="/":t.length>1&&(t.length-=1,i.viewDir=t.join("/")),Ca.dispatch("USER_CONFIG_INFO_PERSIST")};return(e,t)=>{const s=Gl,c=T,d=k,u=Fi,m=Pl,g=Il,p=B;return o(),n("div",Ul,[r("div",Rl,[L(d,{text:"",circle:"",disabled:"/"===C(i).viewDir,onClick:l},{default:E((()=>[L(c,{size:18},{default:E((()=>[L(s)])),_:1})])),_:1},8,["disabled"]),r("div",zl,[L(c,null,{default:E((()=>[L(u)])),_:1}),A(" "+O(C(i).viewDir.split("/").join(" / ")),1)])]),r("div",Ml,[L(m,{position:"management"}),L(p,{placement:"top",content:e.$t("management_page.reload"),"show-arrow":!1,offset:6},{default:E((()=>[L(c,{class:"btn-icon",onClick:t[0]||(t[0]=z((e=>a("reload")),["stop"]))},{default:E((()=>[L(g)])),_:1})])),_:1},8,["content"])])])}}}),[["__scopeId","data-v-0b0f309a"]]);const Hl=(e=>(M("data-v-bc35e904"),e=e(),N(),e))((()=>r("div",{class:"icon"},[r("svg",{t:"1639999626518",class:"icon",viewBox:"0 0 1228 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3575",width:"200",height:"200"},[r("path",{d:"M1196.987733 212.5824v540.0576c0 39.594667-34.474667 71.3728-76.765866 71.3728H323.242667c-51.780267 0-88.746667-46.762667-73.250134-92.808533l126.737067-375.808H70.417067C31.675733 355.362133 0 326.4512 0 291.089067V98.372267C0 63.044267 31.675733 34.0992 70.417067 34.0992h378.811733c26.7264 0 51.029333 13.9264 63.010133 35.703467l39.048534 71.406933H1120.256c42.257067 0 76.8 32.119467 76.8 71.3728",fill:"#5398DF","p-id":"3576"}),r("path",{d:"M1128.721067 997.853867H68.266667a68.266667 68.266667 0 0 1-68.266667-68.266667V280.3712a68.266667 68.266667 0 0 1 68.266667-68.266667h1060.4544a68.266667 68.266667 0 0 1 68.266666 68.266667V929.5872a68.266667 68.266667 0 0 1-68.266666 68.266667",fill:"#85BCFF","p-id":"3577"})])],-1))),jl={class:"text"};var Vl=Ra(w({__name:"folder-card",props:{folderObj:{type:Object,default:()=>{}}},setup(e){const t=f((()=>Ca.getters.getUserConfigInfo)).value,a=e,i=()=>{t.viewDir=a.folderObj.dirPath,Ca.dispatch("USER_CONFIG_INFO_PERSIST")};return(t,a)=>{const l=le("contextmenu");return W((o(),n("div",{class:U(["folder-card border-box",{active:e.folderObj.active}]),onDblclick:i},[Hl,r("div",jl,O(e.folderObj.dir),1)],34)),[[l,{type:C(rl).dir,dir:e.folderObj.dir}]])}}}),[["__scopeId","data-v-bc35e904"]]);const Bl={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Fl=[r("path",{fill:"currentColor",d:"M77.248 415.04a64 64 0 0 1 90.496 0l226.304 226.304L846.528 188.8a64 64 0 1 1 90.56 90.496l-543.04 543.04l-316.8-316.8a64 64 0 0 1 0-90.496"},null,-1)];var Xl={name:"ep-select",render:function(e,t){return o(),n("svg",Bl,[...Fl])}};const ql=["element-loading-text"],Wl={class:"image-card-top border-box"},Jl={class:"image-card-bottom border-box"},Kl={class:"filename text-ellipsis border-box"},Zl={key:0,class:"deploy-status-box"};var Yl=Ra(w({__name:"image-card",props:{imageObj:{type:Object,default:()=>({})},isUploaded:{type:Boolean,default:!1}},setup(e){const t=e,a=f((()=>Ca.getters.getUserSettings)).value,i=f((()=>oa(t.imageObj))),l=f((()=>a.imageLinkType.selected===wt.GitHubPages&&!1===t.imageObj.deployed)),s=x(!1),c=e=>{e.checked=!e.checked,Ca.commit("IMAGE_CARD",{imageObj:e})},d=e=>{t.imageObj.deployed=e};return(t,a)=>{const u=V,m=Xl,g=T,p=Y,_=q,h=le("contextmenu");return W((o(),n("div",{class:U(["image-card border-box",{checked:e.imageObj.checked,active:e.imageObj.active}]),"element-loading-text":t.$t("management_page.loadingTxt3"),onMouseenter:a[4]||(a[4]=e=>s.value=!0),onMouseleave:a[5]||(a[5]=e=>s.value=!1),onClick:a[6]||(a[6]=z((t=>{return a=e.imageObj,void c(a);var a}),["shift"])),ref:"imageCardRef"},[r("div",Wl,[L(u,{src:i.value,fit:"cover",loading:"lazy",lazy:"","hide-on-click-modal":!0,"preview-src-list":C(Ca).getters.getUploadAreaState.pressShiftKey?[]:[i.value],onError:a[0]||(a[0]=e=>d(!1)),onLoad:a[1]||(a[1]=e=>d(!0))},null,8,["src","preview-src-list"])]),r("div",Jl,[r("div",Kl,O(e.imageObj.name),1),r("div",{class:U(["copy-link text-ellipsis border-box",{disabled:l.value}]),onClick:a[2]||(a[2]=t=>C(ca)(e.imageObj))},O(t.$t("copy_link")),3)]),W(r("div",{class:"checked-box flex-center",onClick:a[3]||(a[3]=t=>c(e.imageObj))},[e.imageObj.checked?(o(),P(g,{key:0,size:14},{default:E((()=>[L(m)])),_:1})):$("",!0)],512),[[se,s.value||e.imageObj.checked]]),l.value?(o(),n("div",Zl,[L(p,{type:"danger","disable-transitions":""},{default:E((()=>[A(O(t.$t("settings_page.image_hosting_deploy.not_deployed")),1)])),_:1})])):$("",!0)],42,ql)),[[_,e.imageObj.deleting],[h,{type:C(rl).img,img:e.imageObj}]])}}}),[["__scopeId","data-v-4d5e7435"]]);const Ql={class:"page-container management-page-container"},es={class:"top-box border-box"},ts=["element-loading-text"],as={key:0,class:"dir-card-list list-item border-box"},is={key:1,class:"image-card-list list-item border-box"};var ls=Ra(w({__name:"imgs-management",setup(e){const t=Pa(),a=f((()=>t.getters.getUserConfigInfo)).value,i=f((()=>t.getters.getDirObject)).value,l=x((new Date).getTime()),s=x(!1),c=x([]),d=x([]),u=x(!1);async function m(e){s.value=!0;const l=tt(e,i);if(l){const i=at(l,"dir"),s=at(l,"image");i.length||s.length?(c.value=i,d.value=s,t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:d.value})):await Ht(a,e)}else await Ht(a,e);s.value=!1}async function g(){const{viewDir:e}=a;await t.dispatch("DIR_IMAGE_LIST_INIT_DIR",e),s.value=!0,await Ht(a,e),s.value=!1}return I((()=>{document.addEventListener("keydown",(e=>{16===(e.keyCode||e.which||e.charCode)&&Ca.commit("SET_UPLOAD_AREA_STATE",{pressShiftKey:!0})})),document.addEventListener("keyup",(e=>{16===(e.keyCode||e.which||e.charCode)&&Ca.commit("SET_UPLOAD_AREA_STATE",{pressShiftKey:!1})})),async function(){const{selectedDir:e,viewDir:t,dirMode:l}=a;""===t&&(l!==It.newDir&&l!==It.dateDir||tt(e,i)||(a.selectedDir="/",a.dirMode="rootDir"),a.selectedDir?a.viewDir=a.selectedDir:a.viewDir="/"),i.imageList.length||i.childrenDirs.length?await m(a.viewDir):await Ht(a,a.viewDir)}()})),S((()=>a.viewDir),(async e=>{await m(e),l.value+=1}),{deep:!0}),S((()=>i),(e=>{const{viewDir:i}=a,l=tt(i,e);l&&(c.value=at(l,"dir"),d.value=at(l,"image"),t.commit("REPLACE_IMAGE_CARD",{checkedImgArr:d.value}))}),{deep:!0}),S((()=>d.value),(e=>{u.value=e.filter((e=>e.checked)).length>0}),{deep:!0}),S((()=>t.getters.getUploadAreaState.activeInfo),(e=>{const{type:t,dir:a,img:i}=e||{};d.value.forEach((e=>{e.active=t===rl.img&&e.name===(null==i?void 0:i.name)})),c.value.forEach((e=>{e.active=t===rl.dir&&e.dir===a}))}),{deep:!0}),(e,t)=>{const a=k,i=oe,m=le("contextmenu"),p=q;return o(),n("div",Ql,[r("div",es,[L(Nl,{onReload:g})]),W((o(),n("div",{class:"bottom-box border-box","element-loading-text":e.$t("management_page.loadingTxt1")},[d.value.length?(o(),P(yl,{currentDirImageList:d.value,onUpdateInitImageList:d.value,key:l.value},null,8,["currentDirImageList","onUpdateInitImageList"])):$("",!0),W((o(),n("div",{class:U(["content-list-box border-box",{"has-tools":u.value}])},[c.value.length?(o(),n("ul",as,[(o(!0),n(D,null,G(c.value,((e,t)=>(o(),n("li",{class:"dir-card-item border-box",key:"folder-card-"+e.dir+"-"+t},[L(Vl,{class:U("folder-card-"+t),"folder-obj":e},null,8,["class","folder-obj"])])))),128))])):$("",!0),d.value.length?(o(),n("ul",is,[(o(!0),n(D,null,G(d.value,((e,t)=>(o(),n("li",{class:"image-card-item border-box",key:"image-card-"+t},[L(Yl,{"image-obj":e},null,8,["image-obj"])])))),128))])):$("",!0),d.value.length||c.value.length?$("",!0):(o(),P(i,{key:2},{default:E((()=>[L(a,{type:"primary",onClick:t[0]||(t[0]=e=>C(Yo).push("/upload"))},{default:E((()=>[A(O(e.$t("management_page.text_2")),1)])),_:1})])),_:1}))],2)),[[m,{type:C(rl).dirArea}]])],8,ts)),[[p,s.value]])])}}}),[["__scopeId","data-v-66db3c30"]]);const ss={class:"card-header"},os=["onFocusout"],ns={style:{"margin-top":"20px"}};var rs=Ra(w({__name:"image-link-rule-config",setup(e){const t=J(),a=f((()=>Ca.getters.getUserSettings)).value,i=f((()=>{const e=[];for(const t in a.imageLinkType.presetList)e.push(a.imageLinkType.presetList[t]);return e})),l=x(),s=j({id:"",name:"",rule:"",editable:!0});return(e,a)=>{const n=ne,c=ml,d=k,u=re,m=ce,g=X,p=te,_=ae,h=de;return o(),P(h,null,{header:E((()=>[r("div",ss,[r("span",null,O(e.$t("settings_page.link_rule.card_title")),1)])])),default:E((()=>[L(u,{data:i.value,style:{width:"100%"}},{default:E((()=>[L(n,{prop:"name",label:e.$t("settings_page.link_rule.card_table_col_title_1"),width:"120"},null,8,["label"]),L(n,{label:e.$t("settings_page.link_rule.card_table_col_title_2")},{default:E((e=>[r("div",{contenteditable:!0,onFocusout:t=>((e,t)=>{const a=JSON.parse(JSON.stringify(t));a.rule=e,Ca.dispatch("UPDATE_IMAGE_LINK_TYPE_RULE",{rule:a})})(t.target.innerHTML,e.row)},O(e.row.rule),41,os)])),_:1},8,["label"]),L(n,{label:e.$t("settings_page.link_rule.card_table_col_title_3"),width:"80",align:"center"},{default:E((e=>[L(d,{link:"",size:"small",disabled:!e.row.editable,onClick:a=>{return i=e.row,void v.confirm(`${null==(l=null==t?void 0:t.proxy)?void 0:l.$t("settings_page.link_format.delete_tips")}：<strong>${i.name}</strong>`,null==(s=null==t?void 0:t.proxy)?void 0:s.$t("tip"),{dangerouslyUseHTMLString:!0,type:"warning"}).then((()=>{Ca.dispatch("DEL_IMAGE_LINK_TYPE_RULE",i)})).catch((()=>{}));var i,l,s}},{default:E((()=>[L(c)])),_:2},1032,["disabled","onClick"])])),_:1},8,["label"])])),_:1},8,["data"]),L(m),r("div",ns,[L(_,{ref_key:"formRef",ref:l,"label-position":"left",model:s,"label-width":"120px",size:"default"},{default:E((()=>[L(p,{label:e.$t("settings_page.link_rule.input_name_1"),prop:"name",rules:[{required:!0,message:e.$t("settings_page.link_rule.input_name_1_rule")}]},{default:E((()=>[L(g,{modelValue:s.name,"onUpdate:modelValue":a[0]||(a[0]=e=>s.name=e),type:"text"},null,8,["modelValue"])])),_:1},8,["label","rules"]),L(p,{label:e.$t("settings_page.link_rule.input_name_2"),prop:"rule",rules:[{required:!0,message:e.$t("settings_page.link_rule.input_name_2_rule")}]},{default:E((()=>[L(g,{modelValue:s.rule,"onUpdate:modelValue":a[1]||(a[1]=e=>s.rule=e),type:"text"},null,8,["modelValue"])])),_:1},8,["label","rules"]),L(p,null,{default:E((()=>[L(d,{type:"primary",disabled:!s.name||!s.rule,onClick:a[2]||(a[2]=e=>{var t;(t=l.value)&&t.validate((e=>{e&&(s.id=rt(),Ca.dispatch("ADD_IMAGE_LINK_TYPE_RULE",{rule:JSON.parse(JSON.stringify(s))}))}))})},{default:E((()=>[A(O(e.$t("settings_page.link_rule.btn_name_1")),1)])),_:1},8,["disabled"])])),_:1})])),_:1},8,["model"])])])),_:1})}}}),[["__scopeId","data-v-42167a2f"]]);const cs=w({__name:"watermark-config-box",props:{isTool:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["watermarkConfig"],setup(e,{emit:t}){const a=j({text:"",fontSize:0,position:Lt.rightBottom,textColor:"",opacity:0}),i=t,l=()=>{i("watermarkConfig",a)};return I((()=>{const e=Ca.getters.getUserSettings.watermark;a.text=e.text,a.textColor=e.textColor,a.fontSize=e.fontSize,a.position=e.position,a.opacity=e.opacity,i("watermarkConfig",a)})),(t,i)=>{const s=X,n=te,r=ue,c=me,d=ge,u=pe,m=_e,g=he,p=ae;return o(),P(p,{class:"watermark-config-form","label-position":"left","label-width":"90rem",disabled:e.disabled},{default:E((()=>[L(g,null,{default:E((()=>[L(r,{span:24},{default:E((()=>[L(n,{label:t.$t("settings_page.img_watermark.text")},{default:E((()=>[L(s,{modelValue:a.text,"onUpdate:modelValue":i[0]||(i[0]=e=>a.text=e),placeholder:t.$t("settings_page.img_watermark.text_input_placeholder"),clearable:"",maxlength:"20",onInput:l},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1}),L(r,{span:e.isTool?10:24},{default:E((()=>[L(n,{label:t.$t("settings_page.img_watermark.size")},{default:E((()=>[L(c,{modelValue:a.fontSize,"onUpdate:modelValue":i[1]||(i[1]=e=>a.fontSize=e),min:40,max:80,step:2,onChange:l},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"]),L(r,{span:e.isTool?14:24},{default:E((()=>[L(n,{label:t.$t("settings_page.img_watermark.color")},{default:E((()=>[L(d,{modelValue:a.textColor,"onUpdate:modelValue":i[2]||(i[2]=e=>a.textColor=e),onChange:l},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"]),L(r,{span:e.isTool?10:24},{default:E((()=>[L(n,{label:t.$t("settings_page.img_watermark.opacity")},{default:E((()=>[L(c,{modelValue:a.opacity,"onUpdate:modelValue":i[3]||(i[3]=e=>a.opacity=e),precision:1,step:.1,min:.1,max:.9,onChange:l},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"]),L(r,{span:e.isTool?14:24},{default:E((()=>[L(n,{label:t.$t("settings_page.img_watermark.position")},{default:E((()=>[L(m,{modelValue:a.position,"onUpdate:modelValue":i[4]||(i[4]=e=>a.position=e),onChange:l},{default:E((()=>[L(u,{label:C(Lt).leftTop},{default:E((()=>[A(O(t.$t("settings_page.img_watermark.position_1")),1)])),_:1},8,["label"]),L(u,{label:C(Lt).leftBottom},{default:E((()=>[A(O(t.$t("settings_page.img_watermark.position_2")),1)])),_:1},8,["label"]),L(u,{label:C(Lt).rightTop},{default:E((()=>[A(O(t.$t("settings_page.img_watermark.position_3")),1)])),_:1},8,["label"]),L(u,{label:C(Lt).rightBottom},{default:E((()=>[A(O(t.$t("settings_page.img_watermark.position_4")),1)])),_:1},8,["label"])])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["span"])])),_:1})])),_:1},8,["disabled"])}}});const ds={class:"compress-config-box"},us={class:"img-encoder-title"},ms={class:"desc"},gs={class:"desc"},ps={class:"desc"};var _s,hs,fs=Ra(w({__name:"compress-config-box",props:{disabled:{type:Boolean,default:!1},usageScenario:{type:String,default:"toolbox"}},emits:["encoder"],setup(e,{expose:t,emit:a}){const i=f((()=>Ca.getters.getUserSettings)).value,l=x(bt.webP),s=a,c=e,d=e=>{s("encoder",e)};return I((()=>{"imageHosting"===c.usageScenario&&(l.value=i.compress.encoder),s("encoder",l.value)})),t({reset:()=>{l.value=bt.webP}}),(t,a)=>{const i=pe,s=_e;return o(),n("div",ds,[r("div",us,O(t.$t("settings_page.img_compress.radio_group_title")),1),L(s,{disabled:e.disabled,class:"img-encoder-group",modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),onChange:d},{default:E((()=>[L(i,{label:C(bt).webP},{default:E((()=>[A(O(C(bt).webP)+" ",1),r("span",ms,O(t.$t("settings_page.img_compress.radio_1_desc")),1)])),_:1},8,["label"]),L(i,{label:C(bt).mozJPEG},{default:E((()=>[A(O(C(bt).mozJPEG)+" ",1),r("span",gs,O(t.$t("settings_page.img_compress.radio_2_desc")),1)])),_:1},8,["label"]),L(i,{label:C(bt).avif},{default:E((()=>[A(O(C(bt).avif)+" ",1),r("span",ps,O(t.$t("settings_page.img_compress.radio_3_desc")),1)])),_:1},8,["label"])])),_:1},8,["disabled","modelValue"])])}}}),[["__scopeId","data-v-12614005"]]);(hs=_s||(_s={}))[hs.save=0]="save",hs[hs.use=1]="use",hs[hs.update=2]="update",hs[hs.equal=3]="equal";const vs=async e=>{const{owner:t,repo:a}=e,i=await Mt({url:`/repos/${t}/${a}/contents/.settings`,method:"GET",noShowErrMsg:!0,noCache:!0});return Promise.resolve(i)},bs={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ys=[r("path",{fill:"currentColor",d:"M764.288 214.592L512 466.88L259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512L214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null,-1)];var ws={name:"ep-close",render:function(e,t){return o(),n("svg",bs,[...ys])}};var xs=Ra(w({__name:"cloud-settings-bar",setup(e){const t=fe({IEpCheck:hi,IEpClose:ws}),a=f((()=>Ca.getters.getUserSettings)).value,i=f((()=>Ca.getters.getUserConfigInfo)).value,l=x(!1),s=x(!1),c=x(_s.save),d=f((()=>{switch(c.value){case _s.save:return ot.global.t("settings_page.cloud_settings.tip_1");case _s.use:return ot.global.t("settings_page.cloud_settings.tip_2");case _s.update:return ot.global.t("settings_page.cloud_settings.tip_3");case _s.equal:return ot.global.t("settings_page.cloud_settings.tip_4");default:return ot.global.t("settings_page.cloud_settings.tip_1")}})),m=x(!1),g=async()=>{l.value=!0,await(async(e,t)=>{const{owner:a,repo:i,branch:l}=t,s=await vs(t),o={message:s?"Update settings via PicX (https://github.com/XPoet/picx)":"Init settings via PicX (https://github.com/XPoet/picx)",content:window.btoa(JSON.stringify(e))};s?o.sha=s.sha:o.branch=l;const n=await Mt({url:`/repos/${a}/${i}/contents/.settings`,method:"PUT",data:o,noShowErrMsg:!0});return Promise.resolve(n)})(a,i),l.value=!1,u.success(null===Ca.getters.getCloudSettings?ot.global.t("settings_page.cloud_settings.success_msg_1"):ot.global.t("settings_page.cloud_settings.success_msg_2")),await Ca.dispatch("SET_CLOUD_SETTINGS",JSON.parse(JSON.stringify(a)))},p=()=>{switch(c.value){case _s.save:case _s.update:g();break;case _s.use:Ca.getters.getCloudSettings&&(ut(a,Ca.getters.getCloudSettings),Ca.dispatch("USER_SETTINGS_PERSIST"),Ca.dispatch("SET_GLOBAL_SETTINGS",{useCloudSettings:!0}))}};return S((()=>a),(e=>{Ca.getters.getCloudSettings&&(pt(e,Ca.getters.getCloudSettings)?(c.value=_s.equal,s.value=!0):(c.value=_s.update,s.value=!1))}),{deep:!0}),S((()=>Ca.getters.getCloudSettings),(e=>{e?Ca.getters.getGlobalSettings.useCloudSettings?pt(e,a)?(s.value=!0,c.value=_s.equal):(s.value=!1,c.value=_s.update):pt(e,a)?(s.value=!0,c.value=_s.equal):(s.value=!1,c.value=_s.use):c.value=_s.save}),{deep:!0,immediate:!0}),I((()=>{(async()=>{const e=await vs(i);m.value=!0,await Ca.dispatch("SET_CLOUD_SETTINGS",e?JSON.parse(window.atob(e.content)):null)})()})),(e,a)=>{const i=k;return m.value?(o(),n("div",{key:0,class:U(["cloud-settings-data-box status-bar info",{warning:c.value===C(_s).update,success:c.value===C(_s).equal}])},[r("div",null,O(d.value),1),L(i,{type:"primary",text:"",icon:t.value.IEpCheck,loading:l.value,disabled:s.value,onClick:p},{default:E((()=>[A(O(e.$t("confirm")),1)])),_:1},8,["icon","loading","disabled"])],2)):$("",!0)}}}),[["__scopeId","data-v-6d76458e"]]);const Is={class:"page-container settings-page-container"},Ss={class:"setting-list",style:{"margin-top":"10rem"}},ks={class:"setting-item has-desc"},Ts={class:"desc"},Ls={class:"setting-item has-desc"},Es={class:"desc"},Os={class:"setting-item has-desc"},Cs={class:"desc"},As={key:0,class:"setting-item"},Ps={class:"setting-list"},$s={class:"setting-item has-desc"},Ds={class:"desc"},Gs={class:"setting-item"},Us={class:"setting-list"},Rs={class:"setting-item has-desc"},zs={class:"desc"},Ms={class:"setting-item"},Ns={class:"setting-list"},Hs={class:"setting-item cdn"},js={class:"left"},Vs={class:"right"},Bs={class:"setting-item",style:{"margin-top":"20rem"}},Fs={class:"setting-list"},Xs={class:"setting-item has-desc"},qs={class:"desc"},Ws={class:"setting-item"},Js={class:"left"},Ks={class:"right"},Zs={class:"setting-list"},Ys={class:"setting-item"};var Qs=Ra(w({__name:"picx-settings",setup(e){const t=f((()=>Ca.getters.getUserSettings)).value,a=f((()=>Ca.getters.getGlobalSettings)).value,i=f((()=>Ca.getters.getDeployStatusInfo)).value,l=()=>{Ca.dispatch("USER_SETTINGS_PERSIST")},c=()=>{Ca.dispatch("USER_GLOBAL_PERSIST")},d=()=>{Ca.dispatch("SET_USER_SETTINGS",s({},t))},u=e=>{t.watermark.text=e.text,t.watermark.textColor=e.textColor,t.watermark.opacity=e.opacity,t.watermark.position=e.position,t.watermark.fontSize=e.fontSize,l()};return(e,s)=>{const m=xs,g=ve,p=X,_=be,h=fs,f=de,v=cs,b=ye,y=we,w=rs,x=ai,I=xe;return o(),n("div",Is,[L(m),L(I,null,{default:E((()=>[L(_,{title:e.$t("settings_page.img_name.title"),name:"1"},{default:E((()=>[r("ul",Ss,[r("li",ks,[L(g,{modelValue:C(t).imageName.enableMD5,"onUpdate:modelValue":s[0]||(s[0]=e=>C(t).imageName.enableMD5=e),onChange:l,"active-text":e.$t("settings_page.img_name.md5_switch_name")},null,8,["modelValue","active-text"]),r("span",Ts,O(e.$t("settings_page.img_name.md5_switch_desc")),1)]),r("li",Ls,[L(g,{modelValue:C(t).imageName.enableHash,"onUpdate:modelValue":s[1]||(s[1]=e=>C(t).imageName.enableHash=e),onChange:l,"active-text":e.$t("settings_page.img_name.hash_switch_name")},null,8,["modelValue","active-text"]),r("span",Es,O(e.$t("settings_page.img_name.hash_switch_desc")),1)]),r("li",Os,[L(g,{modelValue:C(t).imageName.addPrefix.enable,"onUpdate:modelValue":s[2]||(s[2]=e=>C(t).imageName.addPrefix.enable=e),onChange:l,"active-text":e.$t("settings_page.img_name.prefix_switch_name")},null,8,["modelValue","active-text"]),r("span",Cs,O(e.$t("settings_page.img_name.prefix_switch_desc")),1)]),C(t).imageName.addPrefix.enable?(o(),n("li",As,[L(p,{class:"prefix-input",modelValue:C(t).imageName.addPrefix.prefix,"onUpdate:modelValue":s[3]||(s[3]=e=>C(t).imageName.addPrefix.prefix=e),placeholder:e.$t("settings_page.img_name.prefix_input_placeholder"),onInput:l,clearable:"",autofocus:""},null,8,["modelValue","placeholder"])])):$("",!0)])])),_:1},8,["title"]),L(_,{title:e.$t("settings_page.img_compress.title"),name:"3"},{default:E((()=>[r("ul",Ps,[r("li",$s,[L(g,{modelValue:C(t).compress.enable,"onUpdate:modelValue":s[4]||(s[4]=e=>C(t).compress.enable=e),onChange:l,"active-text":e.$t("settings_page.img_compress.switch_name")},null,8,["modelValue","active-text"]),r("span",Ds,O(e.$t("settings_page.img_compress.switch_desc")),1)]),r("li",Gs,[L(f,{class:"settings-item-card"},{default:E((()=>[L(h,{ref:"compressConfigBoxRef","usage-scenario":"imageHosting",disabled:!C(t).compress.enable,onEncoder:s[5]||(s[5]=e=>{C(t).compress.encoder=e,l()})},null,8,["disabled"])])),_:1})])])])),_:1},8,["title"]),L(_,{title:e.$t("settings_page.img_watermark.title"),name:"2"},{default:E((()=>[r("ul",Us,[r("li",Rs,[L(g,{modelValue:C(t).watermark.enable,"onUpdate:modelValue":s[6]||(s[6]=e=>C(t).watermark.enable=e),onChange:l,"active-text":e.$t("settings_page.img_watermark.switch_name")},null,8,["modelValue","active-text"]),r("span",zs,O(e.$t("settings_page.img_watermark.switch_desc")),1)]),r("li",Ms,[L(f,{class:"settings-item-card"},{default:E((()=>[L(v,{disabled:!C(t).watermark.enable,onWatermarkConfig:u},null,8,["disabled"])])),_:1})])])])),_:1},8,["title"]),L(_,{title:e.$t("settings_page.link_rule.title"),name:"4"},{default:E((()=>[r("ul",Ns,[r("li",Hs,[A(O(e.$t("settings_page.link_rule.select_title"))+"： ",1),L(y,{modelValue:C(t).imageLinkType.selected,"onUpdate:modelValue":s[7]||(s[7]=e=>C(t).imageLinkType.selected=e),onChange:d},{default:E((()=>[(o(!0),n(D,null,G(C(t).imageLinkType.presetList,(e=>{return o(),P(b,{key:e.name+"-"+e.id,label:e.name,value:e.name,disabled:(t=e.name,t===wt.GitHubPages&&!i.github.status),class:"image-link-type-rule-option"},{default:E((()=>[r("span",js,O(e.name),1),r("span",Vs,O(e.rule),1)])),_:2},1032,["label","value","disabled"]);var t})),128))])),_:1},8,["modelValue"])]),r("li",Bs,[L(w)])])])),_:1},8,["title"]),L(_,{title:e.$t("settings_page.link_format.title"),name:"5"},{default:E((()=>[r("ul",Fs,[r("li",Xs,[L(g,{modelValue:C(t).imageLinkFormat.enable,"onUpdate:modelValue":s[8]||(s[8]=e=>C(t).imageLinkFormat.enable=e),onChange:l,"active-text":e.$t("settings_page.link_format.switch_name")},null,8,["modelValue","active-text"]),r("span",qs,O(e.$t("settings_page.link_format.switch_desc",{type:C(t).imageLinkFormat.selected})),1)]),r("li",Ws,[A(O(e.$t("settings_page.link_format.select_title"))+"： ",1),L(y,{modelValue:C(t).imageLinkFormat.selected,"onUpdate:modelValue":s[9]||(s[9]=e=>C(t).imageLinkFormat.selected=e),onChange:d},{default:E((()=>[(o(!0),n(D,null,G(C(t).imageLinkFormat.presetList,((e,t)=>(o(),P(b,{key:t+e.name,label:e.name,value:e.name,class:"image-link-type-rule-option"},{default:E((()=>[r("span",Js,O(e.name),1),r("span",Ks,O(e.format),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1},8,["title"]),L(_,{title:e.$t("settings_page.image_hosting_deploy.title"),name:"6"},{default:E((()=>[L(x)])),_:1},8,["title"]),L(_,{title:e.$t("settings_page.theme.title"),name:"7"},{default:E((()=>[r("ul",Zs,[r("li",Ys,[A(O(e.$t("header.theme"))+"： ",1),L(y,{modelValue:C(a).theme,"onUpdate:modelValue":s[10]||(s[10]=e=>C(a).theme=e),onChange:c},{default:E((()=>[L(b,{label:e.$t("settings_page.theme.system"),value:C(Ot).system},null,8,["label","value"]),L(b,{label:e.$t("settings_page.theme.light"),value:C(Ot).light},null,8,["label","value"]),L(b,{label:e.$t("settings_page.theme.dark"),value:C(Ot).dark},null,8,["label","value"])])),_:1},8,["modelValue"])])])])),_:1},8,["title"])])),_:1})])}}}),[["__scopeId","data-v-79a522c6"]]);const eo={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},to=[r("path",{fill:"currentColor",d:"M512 64h64v192h-64zm0 576h64v192h-64zM160 480v-64h192v64zm576 0v-64h192v64zM249.856 199.04l45.248-45.184L430.848 289.6L385.6 334.848L249.856 199.104zM657.152 606.4l45.248-45.248l135.744 135.744l-45.248 45.248zM114.048 923.2L68.8 877.952l316.8-316.8l45.248 45.248zM702.4 334.848L657.152 289.6l135.744-135.744l45.248 45.248z"},null,-1)];var ao={name:"ep-magic-stick",render:function(e,t){return o(),n("svg",eo,[...to])}};const io={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},lo=[r("path",{fill:"currentColor",d:"M602.496 240.448A192 192 0 1 1 874.048 512l-316.8 316.8A256 256 0 0 1 195.2 466.752L602.496 59.456l45.248 45.248L240.448 512A192 192 0 0 0 512 783.552l316.8-316.8a128 128 0 1 0-181.056-181.056L353.6 579.904a32 32 0 1 0 45.248 45.248l294.144-294.144l45.312 45.248L444.096 670.4a96 96 0 1 1-135.744-135.744z"},null,-1)];var so={name:"ep-paperclip",render:function(e,t){return o(),n("svg",io,[...lo])}};const oo={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},no=[r("path",{fill:"currentColor",d:"M160 224a32 32 0 0 0-32 32v512a32 32 0 0 0 32 32h704a32 32 0 0 0 32-32V256a32 32 0 0 0-32-32zm0-64h704a96 96 0 0 1 96 96v512a96 96 0 0 1-96 96H160a96 96 0 0 1-96-96V256a96 96 0 0 1 96-96"},null,-1),r("path",{fill:"currentColor",d:"M704 320a64 64 0 1 1 0 128a64 64 0 0 1 0-128M288 448h256q32 0 32 32t-32 32H288q-32 0-32-32t32-32m0 128h256q32 0 32 32t-32 32H288q-32 0-32-32t32-32"},null,-1)];var ro={name:"ep-postcard",render:function(e,t){return o(),n("svg",oo,[...no])}};const co=fe([{name:"toolbox.tool_1",desc:"toolbox.tool_1_desc",icon:ao,uuid:rt(),path:"/compress"},{name:"toolbox.tool_2",desc:"toolbox.tool_2_desc",icon:so,uuid:rt(),path:"/base64"},{name:"toolbox.tool_3",desc:"toolbox.tool_3_desc",icon:ro,uuid:rt(),path:"/watermark"}]);const uo={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},mo=[r("path",{fill:"currentColor",d:"M340.864 149.312a30.59 30.59 0 0 0 0 42.752L652.736 512L340.864 831.872a30.59 30.59 0 0 0 0 42.752a29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"},null,-1)];var go={name:"ep-arrow-right",render:function(e,t){return o(),n("svg",uo,[...mo])}};const po={class:"page-container"},_o={key:0,class:"tool-panel"},ho={class:"panel-header"},fo={class:"panel-body"},vo={key:1,class:"toolbox"},bo=["onClick"],yo={class:"top"},wo={class:"left flex-center"},xo={class:"right"},Io={class:"bottom"};var So=Ra(w({__name:"picx-toolbox",setup(e){const t=fe(go),a=Ie(),i=x("/toolbox"),l=x(!1),c=x({path:"",icon:"",name:"",desc:"",uuid:""}),d=e=>{l.value=!0,c.value=s({},e),Ca.dispatch("TOOLBOX_IMG_LIST_RESET"),a.push(`${i.value}${e.path}`)};S((()=>a.currentRoute.value),(e=>{e.path===i.value&&(l.value=!1)}),{deep:!0});return I((()=>{a.isReady().then((()=>{const e=a.currentRoute.value.path;if(i.value!==e){const t=e.substring(e.lastIndexOf("/")),a=co.value.find((e=>e.path===t));a&&d(a)}}))})),(e,a)=>{const s=Se,u=ke,m=Te("router-view"),g=T;return o(),n("div",po,[l.value?(o(),n("div",_o,[r("div",ho,[L(u,{"separator-icon":t.value},{default:E((()=>[L(s,{to:{path:i.value}},{default:E((()=>[A(O(e.$t("nav.toolbox")),1)])),_:1},8,["to"]),L(s,null,{default:E((()=>[A(O(e.$t(c.value.name)),1)])),_:1})])),_:1},8,["separator-icon"])]),r("div",fo,[L(m)])])):(o(),n("ul",vo,[(o(!0),n(D,null,G(C(co),(t=>(o(),n("li",{class:"tool-item",key:t.uuid,onClick:e=>d(t)},[r("div",yo,[r("div",wo,[L(g,{size:30},{default:E((()=>[(o(),P(Le(t.icon)))])),_:2},1024)]),r("div",xo,O(e.$t(t.name)),1)]),r("div",Io,O(e.$t(t.desc)),1)],8,bo)))),128))]))])}}}),[["__scopeId","data-v-06af4a8d"]]);const ko={class:"page-container feedback-page-container"},To={class:"help-info-item description"},Lo={class:"help-info-item"},Eo={class:"help-info-item"},Oo={class:"help-info-item"},Co={class:"help-info-item"},Ao={class:"help-info-item",style:{"margin-bottom":"2rem"}},Po={class:"help-info-item img"},$o={class:"help-info-item red-text"};var Do=Ra(w({__name:"feedback-info",setup(e){const t=f((()=>"win"===ua()?"Ctrl + D":"Command + D"));return(e,a)=>{const i=Ee,l=V;return o(),n("div",ko,[r("div",To,"🏞️ "+O(e.$t("feedback.text_1")),1),r("div",Lo,[A(" 🌍 "+O(e.$t("feedback.text_2"))+" "+O(e.$t("shortcut_key"))+"：",1),r("code",null,O(t.value),1)]),r("div",Eo,[A(" 🦁 "+O(e.$t("author"))+"： ",1),L(i,{type:"primary",href:"https://xpoet.cn/",target:"_blank"},{default:E((()=>[A("@XPoet")])),_:1})]),r("div",Oo,[A(" 🌀 "+O(e.$t("repo"))+"： ",1),L(i,{type:"primary",href:"https://github.com/XPoet/picx",target:"_blank"},{default:E((()=>[A(" https://github.com/XPoet/picx ")])),_:1})]),r("div",Co,[A(" 📖 "+O(e.$t("document"))+"： ",1),L(i,{type:"primary",href:"https://picx-docs.xpoet.cn",target:"_blank"},{default:E((()=>[A(" https://picx-docs.xpoet.cn ")])),_:1})]),r("div",Ao,"🎁 "+O(e.$t("feedback.text_3")),1),r("div",Po,[L(l,{style:{width:"300rem"},src:"https://xpoet.cn/images/admire-code-wechat.webp"})]),r("div",$o,[r("strong",null," ⚠️ "+O(e.$t("feedback.text_4")),1)])])}}}),[["__scopeId","data-v-3aecdb24"]]);const Go={class:"img-process-state-card-container"},Uo={class:"img-container"},Ro={class:"info-container"},zo={class:"img-name text-ellipsis"},Mo={class:"img-size"},No={key:0,class:"finial-file-size file-size-item"};var Ho=Ra(w({__name:"img-process-state-card",props:{imgObj:{type:Object,require:!0,default:()=>({})},cardType:{type:String,default:"compress"}},emits:["remove"],setup(e,{emit:t}){const a=t;return(t,i)=>{const l=V,s=xi,c=T,d=B,m=q;return o(),n("div",Go,[W((o(),n("div",Uo,[L(l,{src:e.imgObj.finialBase64||e.imgObj.originalBase64,fit:"cover",loading:"lazy","hide-on-click-modal":!0,"preview-src-list":[e.imgObj.finialBase64||e.imgObj.originalBase64]},null,8,["src","preview-src-list"])])),[[m,e.imgObj.processing]]),r("div",Ro,[r("div",zo,O(e.imgObj.finialName||e.imgObj.originalName),1),r("div",Mo,[r("div",{class:U(["original-file-size file-size-item",{"del-line":e.imgObj.finialSize&&"compress"===e.cardType}])},O(C(ia)(e.imgObj.originalSize))+" KB ",3),e.imgObj.finialSize&&"compress"===e.cardType?(o(),n("div",No,O(C(ia)(e.imgObj.finialSize))+" KB ",1)):$("",!0)])]),e.imgObj.finialFile?(o(),n("div",{key:0,class:"operate-container flex-center",onClick:i[0]||(i[0]=t=>{ea(e.imgObj.finialFile)})},O(t.$t("toolbox.click_download")),1)):$("",!0),"base64"===e.cardType&&e.imgObj.originalBase64?(o(),n("div",{key:1,class:"operate-container flex-center",onClick:i[1]||(i[1]=a=>{return i=e.imgObj.originalBase64,l=t.$t,void ct(i,(()=>{u.success({message:l("toolbox.copy_base64_success")})}));var i,l})},O(t.$t("toolbox.copy_base64")),1)):$("",!0),L(d,{placement:"top",offset:8,content:t.$t("delete")},{default:E((()=>[L(c,{class:"del-btn",onClick:i[2]||(i[2]=t=>{return i=e.imgObj.uuid,void a("remove",i);var i})},{default:E((()=>[L(s)])),_:1})])),_:1},8,["content"])])}}}),[["__scopeId","data-v-d59c7528"]]);const jo={class:"compress-tool-container"},Vo={key:0,class:"compress-tool-left"};var Bo=Ra(w({__name:"compress-tool",setup(e){const t=Pa(),a=x(null),i=x(null),l=x([]),s=x(bt.webP),c=x(!1),d=x(!1),u=e=>{d.value=!1,c.value=!1,e.forEach((e=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:e.uuid,originalName:e.file.name,originalSize:e.file.size,originalBase64:e.base64,originalFile:e.file})}))},m=()=>{var e,l;t.dispatch("TOOLBOX_IMG_LIST_RESET"),d.value=!1,null==(e=a.value)||e.reset(),null==(l=i.value)||l.reset()},g=async()=>{c.value=!0;for(const e of l.value)e.processing=!0,e.finialFile=await sa(e.originalFile,s.value),e.finialBase64=await Qt(e.finialFile)||"",e.finialSize=e.finialFile.size,e.finialName=e.finialFile.name,e.processing=!1;d.value=!0,c.value=!1},p=()=>{l.value.forEach((e=>{ea(e.finialFile)}))},_=e=>{var i;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",e),null==(i=a.value)||i.remove(e)};return S((()=>t.state.toolboxImageListModule.toolboxImageList),(e=>{l.value=e}),{immediate:!0,deep:!0}),(e,t)=>{const h=Ho,f=di,v=fs,b=k;return o(),n("div",jo,[l.value.length?(o(),n("div",Vo,[(o(!0),n(D,null,G(l.value,(e=>(o(),P(h,{"img-obj":e,key:e.uuid,onRemove:_},null,8,["img-obj"])))),128))])):$("",!0),r("div",{class:U(["compress-tool-right",{"no-img":!l.value.length}])},[L(f,{ref_key:"gettingImagesRef",ref:a,onGetImgList:u},null,512),L(v,{ref_key:"compressConfigBoxRef",ref:i,style:{"margin-top":"18rem"},onEncoder:t[0]||(t[0]=e=>{return t=e,d.value=!1,void(s.value=t);var t})},null,512),r("div",{class:U(["user-operate",{compressed:d.value&&l.value.length>1}])},[d.value&&l.value.length>1?(o(),P(b,{key:0,plain:"",type:"success",onClick:p},{default:E((()=>[A(O(e.$t("toolbox.batch_download")),1)])),_:1})):$("",!0),r("div",null,[l.value.length?(o(),P(b,{key:0,plain:"",type:"warning",onClick:m},{default:E((()=>[A(O(e.$t("reset")),1)])),_:1})):$("",!0),l.value.length?(o(),P(b,{key:1,disabled:c.value||d.value,plain:"",type:"primary",onClick:g},{default:E((()=>[A(O(e.$t("toolbox.compress")),1)])),_:1},8,["disabled"])):$("",!0)])],2)],2)])}}}),[["__scopeId","data-v-2f45486b"]]);const Fo={class:"base64-tool-container"},Xo={key:0,class:"base64-tool-left"},qo={class:"user-operate"},Wo=w({__name:"base64-tool",setup(e){const t=Pa(),a=x(null),i=x([]),l=e=>{e.forEach((e=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:e.uuid,originalName:e.file.name,originalSize:e.file.size,originalBase64:e.base64})}))},s=()=>{var e;t.dispatch("TOOLBOX_IMG_LIST_RESET"),null==(e=a.value)||e.reset()},c=e=>{var i;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",e),null==(i=a.value)||i.remove(e)};return S((()=>t.state.toolboxImageListModule.toolboxImageList),(e=>{i.value=e}),{immediate:!0,deep:!0}),(e,t)=>{const d=Ho,u=di,m=k;return o(),n("div",Fo,[i.value.length?(o(),n("div",Xo,[(o(!0),n(D,null,G(i.value,(e=>(o(),P(d,{"card-type":"base64","img-obj":e,key:e.uuid,onRemove:c},null,8,["img-obj"])))),128))])):$("",!0),r("div",{class:U(["base64-tool-right",{"no-img":!i.value.length}])},[L(u,{ref_key:"gettingImagesRef",ref:a,onGetImgList:l},null,512),r("div",qo,[i.value.length?(o(),P(m,{key:0,plain:"",type:"warning",onClick:s},{default:E((()=>[A(O(e.$t("reset")),1)])),_:1})):$("",!0)])],2)])}}});const Jo={class:"watermark-tool-container"},Ko={key:0,class:"watermark-tool-left"};const Zo=[{path:"/",name:"login",component:Fa,meta:{title:"login"}},{path:"/config",name:"config",component:()=>{return e=()=>import("./picx-config.2ca2e190.js"),(t=["assets/picx-config.2ca2e190.js","assets/picx-config.f71816f7.css","assets/vendor.10d14369.js","assets/vendor.91ab84e9.css"])&&0!==t.length?Promise.all(t.map((e=>{if((e=`./${e}`)in Me)return;Me[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script",i.crossOrigin=""),i.href=e,document.head.appendChild(i),t?new Promise(((e,t)=>{i.addEventListener("load",e),i.addEventListener("error",t)})):void 0}))).then((()=>e())):e();var e,t},meta:{title:"nav.config"}},{path:"/upload",name:"upload",component:nl,meta:{title:"nav.upload"}},{path:"/management",name:"Management",component:ls,meta:{title:"nav.management"}},{path:"/settings",name:"settings",component:Qs,meta:{title:"nav.settings"}},{path:"/toolbox",name:"Toolbox",component:So,meta:{title:"nav.toolbox"},children:[{path:"/toolbox/compress",name:"Compress",component:Bo},{path:"/toolbox/base64",name:"Base64",component:Ra(Wo,[["__scopeId","data-v-654d8c19"]])},{path:"/toolbox/watermark",name:"Watermark",component:Ra(w({__name:"watermark-tool",setup(e){const t=Pa(),a=j({enable:!0,text:"",fontSize:0,opacity:0,position:Lt.rightBottom,textColor:""}),i=x(null),l=x([]),s=x(!1),c=x(!1),d=e=>{c.value=!1,s.value=!1,e.forEach((e=>{t.dispatch("TOOLBOX_IMG_LIST_ADD",{uuid:e.uuid,originalName:e.file.name,originalSize:e.file.size,originalBase64:e.base64,originalFile:e.file})}))},u=e=>{a.text=e.text,a.textColor=e.textColor,a.opacity=e.opacity,a.position=e.position,a.fontSize=e.fontSize,c.value=!1},m=()=>{var e;t.dispatch("TOOLBOX_IMG_LIST_RESET"),c.value=!1,null==(e=i.value)||e.reset()},g=async()=>{s.value=!0;for(const e of l.value)e.processing=!0,e.finialFile=await $t(e.originalFile,a),e.finialBase64=await Qt(e.finialFile)||"",e.finialSize=e.finialFile.size,e.finialName=e.finialFile.name,e.processing=!1;c.value=!0,s.value=!1},p=()=>{l.value.forEach((e=>{ea(e.finialFile)}))},_=e=>{var a;t.dispatch("TOOLBOX_IMG_LIST_REMOVE",e),null==(a=i.value)||a.remove(e)};return S((()=>t.state.toolboxImageListModule.toolboxImageList),(e=>{l.value=e}),{immediate:!0,deep:!0}),(e,t)=>{const h=Ho,f=di,v=cs,b=k;return o(),n("div",Jo,[l.value.length?(o(),n("div",Ko,[(o(!0),n(D,null,G(l.value,(e=>(o(),P(h,{"img-obj":e,key:e.uuid,"card-type":"watermark",onRemove:_},null,8,["img-obj"])))),128))])):$("",!0),r("div",{class:U(["watermark-tool-right",{"no-img":!l.value.length}])},[L(f,{ref_key:"gettingImagesRef",ref:i,onGetImgList:d},null,512),L(v,{isTool:!0,onWatermarkConfig:u,style:{"margin-top":"18rem"}}),r("div",{class:U(["user-operate",{watermarked:c.value&&l.value.length>1}])},[c.value&&l.value.length>1?(o(),P(b,{key:0,plain:"",type:"success",onClick:p},{default:E((()=>[A(O(e.$t("toolbox.batch_download")),1)])),_:1})):$("",!0),r("div",null,[l.value.length?(o(),P(b,{key:0,plain:"",type:"warning",onClick:m},{default:E((()=>[A(O(e.$t("reset")),1)])),_:1})):$("",!0),l.value.length?(o(),P(b,{key:1,disabled:s.value||c.value||!a.text,plain:"",type:"primary",onClick:g},{default:E((()=>[A(O(e.$t("toolbox.add_watermark")),1)])),_:1},8,["disabled"])):$("",!0)])],2)],2)])}}}),[["__scopeId","data-v-8c458a98"]])}]},{path:"/feedback",name:"feedback",component:Do,meta:{title:"nav.feedback"}},{path:"/:catchAll(.*)",redirect:"/"}],Yo=Oe({history:Ce(),routes:Zo});Yo.beforeEach(((e,t,a)=>{e.meta.title&&gt(e.meta.title),a()}));const Qo=()=>{const e=Pa(),t=async e=>{await Ae((()=>{const t=document.getElementsByTagName("html")[0];e===Ot.dark&&(t.classList.remove("light"),t.classList.add("dark")),e===Ot.light&&(t.classList.remove("dark"),t.classList.add("light"))}))},a=async e=>{e===Ot.system?await t(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Ot.dark:Ot.light):await t(e)};S((()=>e.getters.getGlobalSettings.theme),(async e=>{await a(e)}),{deep:!0,immediate:!0})},en={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},tn=[r("path",{fill:"currentColor",d:"M288 320a224 224 0 1 0 448 0a224 224 0 1 0-448 0m544 608H160a32 32 0 0 1-32-32v-96a160 160 0 0 1 160-160h448a160 160 0 0 1 160 160v96a32 32 0 0 1-32 32z"},null,-1)];var an={name:"ep-user-filled",render:function(e,t){return o(),n("svg",en,[...tn])}};const ln={class:"avatar flex-center"},sn=["src","alt"],on={class:"personal-center-popover border-box"},nn={key:0,class:"user-info border-box"},rn={key:0,class:"info-item owner"},cn={key:1,class:"info-item name"},dn={class:"content-item border-box"},un={class:"flex-center"},mn={class:"content-item border-box"},gn={class:"flex-center"};var pn=Ra(w({__name:"user-avatar-v2",setup(e){const t=Ie(),a=Pa(),i=f((()=>a.getters.getUserConfigInfo)).value,l=f((()=>a.getters.getGlobalSettings)).value,s=()=>{t.push("/login"),document.body.click()},c=()=>{a.dispatch("LOGOUT"),t.push("/login"),document.body.click(),setTimeout((()=>{window.location.reload()}))},d=()=>{a.dispatch("USER_GLOBAL_PERSIST")};return(e,t)=>{const u=an,m=T,g=Ei,p=Ee,_=ce,h=ye,f=we,v=Pe;return o(),P(v,{placement:"bottom-end",trigger:"click",width:"240rem","show-arrow":!1,"popper-style":{padding:"0","border-radius":"10rem",overflow:"hidden"}},{reference:E((()=>{var e,t,l;return[r("div",{class:U(["user-avatar-v2 border-box",{folded:C(a).getters.getGlobalSettings.folded}])},[r("div",ln,[(null==(e=C(i))?void 0:e.avatarUrl)?(o(),n("img",{key:0,src:null==(t=C(i))?void 0:t.avatarUrl,alt:null==(l=C(i))?void 0:l.owner},null,8,sn)):(o(),P(m,{key:1,class:"user-filled-icon"},{default:E((()=>[L(u)])),_:1}))]),L(m,{class:"popover-tip-icon"},{default:E((()=>[L(g)])),_:1})],2)]})),default:E((()=>[r("ul",on,[C(i).logined?(o(),n("li",nn,[C(i).owner?(o(),n("div",rn,[L(p,{style:{"font-size":"16rem"},underline:!1,href:C(ga)(C(i)),target:"_blank"},{default:E((()=>[A(O(C(i).owner),1)])),_:1},8,["href"])])):$("",!0),C(i).email?(o(),n("div",cn,O(C(i).email),1)):$("",!0)])):$("",!0),C(i).logined?(o(),P(_,{key:1})):$("",!0),r("li",dn,[r("span",un,O(e.$t("language")),1),L(f,{size:"small",style:{width:"100rem"},modelValue:C(l).language,"onUpdate:modelValue":t[0]||(t[0]=e=>C(l).language=e),onChange:d},{default:E((()=>[L(h,{label:"中文简体",value:C(At).zhCN},null,8,["value"]),L(h,{label:"中文繁體",value:C(At).zhTW},null,8,["value"]),L(h,{label:"English",value:C(At).en},null,8,["value"])])),_:1},8,["modelValue"])]),L(_),r("li",mn,[r("span",gn,O(e.$t("header.theme")),1),L(f,{size:"small",style:{width:"100rem"},modelValue:C(l).theme,"onUpdate:modelValue":t[1]||(t[1]=e=>C(l).theme=e),onChange:d},{default:E((()=>[L(h,{label:e.$t("settings_page.theme.system"),value:C(Ot).system},null,8,["label","value"]),L(h,{label:e.$t("settings_page.theme.light"),value:C(Ot).light},null,8,["label","value"]),L(h,{label:e.$t("settings_page.theme.dark"),value:C(Ot).dark},null,8,["label","value"])])),_:1},8,["modelValue"])]),L(_),C(i).name||C(i).owner?(o(),n("li",{key:2,class:"content-item border-box",onClick:c},O(e.$t("logout")),1)):(o(),n("li",{key:3,class:"content-item border-box",onClick:s},O(e.$t("login")),1))])])),_:1})}}}),[["__scopeId","data-v-af79b982"]]);const _n={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},hn=[r("path",{fill:"currentColor",d:"M389.44 768a96.064 96.064 0 0 1 181.12 0H896v64H570.56a96.064 96.064 0 0 1-181.12 0H128v-64zm192-288a96.064 96.064 0 0 1 181.12 0H896v64H762.56a96.064 96.064 0 0 1-181.12 0H128v-64zm-320-288a96.064 96.064 0 0 1 181.12 0H896v64H442.56a96.064 96.064 0 0 1-181.12 0H128v-64z"},null,-1)];var fn={name:"ep-operation",render:function(e,t){return o(),n("svg",_n,[...hn])}};const vn={class:"quick-actions-popover"},bn=w({__name:"quick-actions",setup(e){const t=f((()=>Ca.getters.getUserSettings)).value,a=f((()=>Ca.getters.getGlobalSettings)).value,i=()=>{Ca.dispatch("USER_SETTINGS_PERSIST")};return(e,l)=>{const s=fn,n=T,c=k,d=ve,u=Pe;return o(),P(u,{placement:"bottom-end",width:"en"===C(a).language?"230rem":"190rem",trigger:"click","show-arrow":!1,"popper-style":{padding:"0","border-radius":"10rem",overflow:"hidden"}},{reference:E((()=>[L(c,{circle:"",text:""},{default:E((()=>[L(n,{size:22},{default:E((()=>[L(s)])),_:1})])),_:1})])),default:E((()=>[r("div",vn,[L(d,{modelValue:C(t).watermark.enable,"onUpdate:modelValue":l[0]||(l[0]=e=>C(t).watermark.enable=e),"active-text":e.$t("actions.watermark"),onChange:i},null,8,["modelValue","active-text"]),L(d,{modelValue:C(t).compress.enable,"onUpdate:modelValue":l[1]||(l[1]=e=>C(t).compress.enable=e),"active-text":e.$t("actions.compress"),onChange:i},null,8,["modelValue","active-text"]),L(d,{modelValue:C(t).imageLinkFormat.enable,"onUpdate:modelValue":l[2]||(l[2]=e=>C(t).imageLinkFormat.enable=e),"active-text":e.$t("actions.transform")+C(t).imageLinkFormat.selected,onChange:i},null,8,["modelValue","active-text"])])])),_:1},8,["width"])}}});const yn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},wn=[r("path",{fill:"currentColor",d:"M512 64a64 64 0 0 1 64 64v64H448v-64a64 64 0 0 1 64-64"},null,-1),r("path",{fill:"currentColor",d:"M256 768h512V448a256 256 0 1 0-512 0zm256-640a320 320 0 0 1 320 320v384H192V448a320 320 0 0 1 320-320"},null,-1),r("path",{fill:"currentColor",d:"M96 768h832q32 0 32 32t-32 32H96q-32 0-32-32t32-32m352 128h128a64 64 0 0 1-128 0"},null,-1)];var xn={name:"ep-bell",render:function(e,t){return o(),n("svg",yn,[...wn])}};const In={class:"announcement-item"},Sn={class:"announcement-item"};var kn=Ra(w({__name:"site-announcement",setup(e){const t=x(!1),a=f((()=>Ca.getters.getGlobalSettings)).value,i=f((()=>Ca.getters.getUserSettings)).value,l=()=>{Ca.dispatch("SET_GLOBAL_SETTINGS",{showAnnouncement:!1})},s=()=>{t.value=!1,Ca.dispatch("SET_USER_SETTINGS",{showAnnouncement:!1})};return I((()=>{a.showAnnouncement&&i.showAnnouncement&&(t.value=!0)})),(e,a)=>{const c=xn,d=T,u=k,m=Ee,g=ie;return o(),n(D,null,[L(u,{class:U(["site-announcement-btn border-box",{dot:C(i).showAnnouncement}]),circle:"",text:"",onClick:a[0]||(a[0]=e=>t.value=!0)},{default:E((()=>[L(d,{size:22},{default:E((()=>[L(c)])),_:1})])),_:1},8,["class"]),L(g,{modelValue:t.value,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value=e),title:e.$t("header.announcement.text_1"),width:"500",modal:!1,draggable:"",onClose:l},{footer:E((()=>[L(u,{onClick:s},{default:E((()=>[A(O(e.$t("header.announcement.text_4")),1)])),_:1})])),default:E((()=>[r("div",In,O(e.$t("header.announcement.text_2")),1),r("div",Sn,[A(O(e.$t("header.announcement.text_3"))+" ",1),L(m,{type:"primary",target:"_blank",href:"https://v2.picx.xpoet.cn"},{default:E((()=>[A(" PicX v2.0 ")])),_:1})])])),_:1},8,["modelValue","title"])],64)}}}),[["__scopeId","data-v-83c2f27c"]]);const Tn={class:"header-content-box border-box"},Ln={class:"header-left border-box"},En={class:"brand-box"},On=[(e=>(M("data-v-cf37255e"),e=e(),N(),e))((()=>r("img",{src:"./assets/logo.ffee4291.png",alt:"PicX"},null,-1)))],Cn={class:"header-right"},An={class:"btn-item"},Pn={key:0,class:"btn-item"},$n={class:"btn-item avatar"};var Dn=Ra(w({__name:"header-content",setup(e){const t=f((()=>Ca.getters.getUserConfigInfo));return(e,a)=>{const i=bn,l=pn;return o(),n("header",Tn,[r("div",Ln,[r("div",En,[r("div",{class:"logo",onClick:a[0]||(a[0]=e=>C(Yo).push("/"))},On),r("div",{class:"title",onClick:a[1]||(a[1]=e=>C(Yo).push("/"))},"PicX")])]),r("div",Cn,[r("div",An,[L(kn)]),t.value.logined?(o(),n("div",Pn,[L(i)])):$("",!0),r("div",$n,[L(l)])])])}}}),[["__scopeId","data-v-cf37255e"]]);const Gn={class:"count-item border-box"},Un=r("span",{class:"pv",id:"busuanzi_value_site_pv"},null,-1),Rn={class:"count-item border-box"},zn=r("span",{class:"uv",id:"busuanzi_value_site_uv"},null,-1),Mn=w({__name:"site-count",props:{showUV:{type:Boolean,default:!1},showPV:{type:Boolean,default:!1}},setup(e){const t=x(null),a=x(!1);return I((()=>{const e=document.createElement("script");e.async=!0,e.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",t.value.appendChild(e),e.onload=()=>{setTimeout((()=>{var e,i;(null==(i=null==(e=t.value)?void 0:e.querySelector(".pv"))?void 0:i.innerText)&&(a.value=!0)}),1500)}})),(i,l)=>W((o(),n("div",{class:"site-count border-box",ref_key:"siteCountDom",ref:t},[W(r("span",Gn,[A(" PV "),Un],512),[[se,e.showPV]]),W(r("span",Rn,[A(" UV "),zn],512),[[se,e.showUV]])],512)),[[se,a.value]])}}),Nn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Hn=[r("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0a30.59 30.59 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.59 30.59 0 0 1-.512 43.264a29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672zm256 0a29.12 29.12 0 0 1 41.728 0a30.59 30.59 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.59 30.59 0 0 1-.512 43.264a29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672z"},null,-1)];var jn={name:"ep-d-arrow-left",render:function(e,t){return o(),n("svg",Nn,[...Hn])}};const Vn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Bn=[r("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0a30.59 30.59 0 0 1 0-42.752L764.736 512L452.864 192a30.59 30.59 0 0 1 0-42.688m-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0a30.59 30.59 0 0 1 0-42.752L508.736 512L196.864 192a30.59 30.59 0 0 1 0-42.688"},null,-1)];var Fn={name:"ep-d-arrow-right",render:function(e,t){return o(),n("svg",Vn,[...Bn])}};const Xn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},qn=[r("path",{fill:"currentColor",d:"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640z"},null,-1),r("path",{fill:"currentColor",d:"m469.952 554.24l52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"},null,-1)];var Wn={name:"ep-edit",render:function(e,t){return o(),n("svg",Xn,[...qn])}};const Jn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Kn=[r("path",{fill:"currentColor",d:"M160 160v704h704V160zm-32-64h768a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H128a32 32 0 0 1-32-32V128a32 32 0 0 1 32-32"},null,-1),r("path",{fill:"currentColor",d:"M384 288q64 0 64 64t-64 64t-64-64t64-64M185.408 876.992l-50.816-38.912L350.72 556.032a96 96 0 0 1 134.592-17.856l1.856 1.472l122.88 99.136a32 32 0 0 0 44.992-4.864l216-269.888l49.92 39.936l-215.808 269.824l-.256.32a96 96 0 0 1-135.04 14.464l-122.88-99.072l-.64-.512a32 32 0 0 0-44.8 5.952z"},null,-1)];var Zn={name:"ep-picture",render:function(e,t){return o(),n("svg",Jn,[...Kn])}};const Yn={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Qn=[r("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357 357 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a352 352 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357 357 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088l-24.512 11.968a294 294 0 0 0-34.816 20.096l-22.656 15.36l-116.224-25.088l-65.28 113.152l79.68 88.192l-1.92 27.136a293 293 0 0 0 0 40.192l1.92 27.136l-79.808 88.192l65.344 113.152l116.224-25.024l22.656 15.296a294 294 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152l24.448-11.904a288 288 0 0 0 34.752-20.096l22.592-15.296l116.288 25.024l65.28-113.152l-79.744-88.192l1.92-27.136a293 293 0 0 0 0-40.256l-1.92-27.136l79.808-88.128l-65.344-113.152l-116.288 24.96l-22.592-15.232a288 288 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384a192 192 0 0 1 0-384m0 64a128 128 0 1 0 0 256a128 128 0 0 0 0-256"},null,-1)];var er={name:"ep-setting",render:function(e,t){return o(),n("svg",Yn,[...Qn])}};const tr={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},ar=[r("path",{fill:"currentColor",d:"M128 384v448h768V384zm-32-64h832a32 32 0 0 1 32 32v512a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V352a32 32 0 0 1 32-32m64-128h704v64H160zm96-128h512v64H256z"},null,-1)];var ir={name:"ep-files",render:function(e,t){return o(),n("svg",tr,[...ar])}};const lr={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},sr=[r("path",{fill:"currentColor",d:"m174.72 855.68l135.296-45.12l23.68 11.84C388.096 849.536 448.576 864 512 864c211.84 0 384-166.784 384-352S723.84 160 512 160S128 326.784 128 512c0 69.12 24.96 139.264 70.848 199.232l22.08 28.8l-46.272 115.584zm-45.248 82.56A32 32 0 0 1 89.6 896l58.368-145.92C94.72 680.32 64 596.864 64 512C64 299.904 256 96 512 96s448 203.904 448 416s-192 416-448 416a461.06 461.06 0 0 1-206.912-48.384l-175.616 58.56z"},null,-1),r("path",{fill:"currentColor",d:"M512 563.2a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4m192 0a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4m-384 0a51.2 51.2 0 1 1 0-102.4a51.2 51.2 0 0 1 0 102.4"},null,-1)];var or={name:"ep-chat-dot-round",render:function(e,t){return o(),n("svg",lr,[...sr])}};const nr=fe([{uuid:rt(),name:"nav.config",icon:Wn,isActive:!1,path:"/config",isShow:!0},{uuid:rt(),name:"nav.upload",icon:bi,isActive:!1,path:"/upload",isShow:!0},{uuid:rt(),name:"nav.management",icon:Zn,isActive:!1,path:"/management",isShow:!0},{uuid:rt(),name:"nav.settings",icon:er,isActive:!1,path:"/settings",isShow:!0},{uuid:rt(),name:"nav.toolbox",icon:ir,isActive:!1,path:"/toolbox",isShow:!0},{uuid:rt(),name:"nav.feedback",icon:or,isActive:!1,path:"/feedback",isShow:!0}]);const rr={class:"top-box border-box"},cr={class:"nav-menu-list border-box"},dr=["onClick"],ur={class:"nav-name"},mr={class:"bottom-box border-box"};var gr=Ra(w({__name:"nav-content",setup(e){const t=Ie(),a=Pa(),i=f((()=>a.getters.getUserConfigInfo)).value,l=f((()=>a.getters.getGlobalSettings)).value,s=f((()=>{switch(l.elementPlusSize){case kt.small:return 21;case kt.large:return 25;default:return 23}})),c=e=>{nr.value.forEach((t=>{const a=t;return a.isActive=t.path===e||e.includes(t.path),a})),$e(nr)},d=()=>{a.dispatch("SET_GLOBAL_SETTINGS",{folded:!l.folded})};return S((()=>t.currentRoute.value),(e=>{c(e.path)})),S((()=>i.logined),(e=>{nr.value.forEach((t=>{switch(t.path){case"/management":case"/settings":t.isShow=e}}))}),{deep:!0,immediate:!0}),I((()=>{t.isReady().then((()=>{c(t.currentRoute.value.path)}))})),(e,c)=>{const m=T,g=B,p=Fn,_=jn,h=Mn;return o(),n("aside",{class:U(["nav-content-container border-box",{folded:C(a).getters.getGlobalSettings.folded}])},[r("div",rr,[r("ul",cr,[(o(!0),n(D,null,G(C(nr),((l,n)=>(o(),P(g,{placement:"left",content:e.$t(l.name),key:n+l.uuid,"show-arrow":!1,disabled:!C(a).getters.getGlobalSettings.folded},{default:E((()=>[W(r("li",{class:U(["nav-menu-item border-box",{active:l.isActive}]),onClick:e=>(e=>{const{path:a}=e;if("/management"===a){if(""===i.repo)return u.warning(ot.global.t("upload_page.message2")),void t.push("/config");if(""===i.selectedDir)return u.warning(ot.global.t("upload_page.message3")),void t.push("/config")}t.push(a)})(l)},[L(m,{class:"nav-icon",size:s.value},{default:E((()=>[(o(),P(Le(l.icon)))])),_:2},1032,["size"]),r("span",ur,O(e.$t(l.name)),1)],10,dr),[[se,l.isShow]])])),_:2},1032,["content","disabled"])))),128))])]),r("div",mr,[C(l).folded?(o(),P(m,{key:0,class:"fold-icon",onClick:d},{default:E((()=>[L(p)])),_:1})):(o(),P(m,{key:1,class:"fold-icon",onClick:d},{default:E((()=>[L(_)])),_:1})),L(h,{class:"site-count",showPV:!0,showUV:!0})])],2)}}}),[["__scopeId","data-v-2520ce1f"]]);const pr={class:"main-container"},_r={class:"top-container border-box"},hr={class:"bottom-container border-box"},fr={class:"bottom-right-box border-box"};var vr=Ra(w({__name:"main-container",setup(e){const t=async()=>{const e=await Wa();e&&await(async e=>{await Ca.dispatch("SET_DEPLOY_STATUS_INFO",JSON.parse(window.atob(e)))})(e.content)};return I((()=>{Qo(),t()})),(e,t)=>{const a=Te("router-view");return o(),n("main",pr,[r("div",_r,[L(Dn)]),r("div",hr,[r("div",{class:U(["bottom-left-box border-box",{folded:C(Ca).getters.getGlobalSettings.folded}])},[L(gr)],2),r("div",fr,[L(a)])])])}}}),[["__scopeId","data-v-1c221c2d"]]);const br=w({__name:"app-wrap",setup(e){const t=J(),a=Pa(),i=f((()=>a.getters.getGlobalSettings)).value,l=x(kt.default),s=x(Ge),n=e=>{e<=700?(null==a||a.dispatch("SET_GLOBAL_SETTINGS",{elementPlusSize:kt.small,folded:!0}),l.value=kt.small):e<=1e3?(null==a||a.dispatch("SET_GLOBAL_SETTINGS",{elementPlusSize:kt.default,folded:!1}),l.value=kt.default):(null==a||a.dispatch("SET_GLOBAL_SETTINGS",{elementPlusSize:kt.large,folded:!1}),l.value=kt.large)},r=e=>{var a,i,l,o;e===At.zhCN?(t.proxy.$i18n.locale="zh-CN",s.value=Ge,null==(a=window.pluginWebUpdateNotice_)||a.setLocale("zh_CN")):e===At.zhTW?(t.proxy.$i18n.locale="zh-TW",s.value=Ue,null==(i=window.pluginWebUpdateNotice_)||i.setLocale("zh_TW")):e===At.en?(t.proxy.$i18n.locale="en",s.value=Re,null==(l=window.pluginWebUpdateNotice_)||l.setLocale("en_US")):(s.value=Ge,t.proxy.$i18n.locale="zh-CN",null==(o=window.pluginWebUpdateNotice_)||o.setLocale("zh_CN")),gt(Yo.currentRoute.value.meta.title)},c=()=>{a.getters.getGlobalSettings.languageToggleTip&&(async()=>{try{const e=await d.get("https://api.ipify.org?format=json"),t=await d.get(`https://ipapi.co/${e.data.ip}/country/`);return Promise.resolve(t.data)}catch(e){return Promise.resolve("CN")}})().then((e=>{var l,s,o,n,c;const d=(e=>"CN"===e?At.zhCN:"HK"===e||"TW"===e||"MO"===e?At.zhTW:At.en)(e);if(d!==i.language){const i=null==(l=null==t?void 0:t.proxy)?void 0:l.$t("confirm",d),m=null==(n=null==t?void 0:t.proxy)?void 0:n.$t("toggle_language_msg",d,{region:null==(s=null==t?void 0:t.proxy)?void 0:s.$t(`region.${e}`,d),language:null==(o=null==t?void 0:t.proxy)?void 0:o.$t(`languages.${d}`,d)}),g=u({customClass:"custom-message-container",duration:0,offset:20,type:"info",message:`<div class="content-box language">\n                    <span class="msg">${m}</span>\n                    <spna class="btn-box">\n                      <span class="confirm btn">${i}</span>\n                    </spna>\n                  </div>`,dangerouslyUseHTMLString:!0,showClose:!0,onClose(){a.dispatch("SET_GLOBAL_SETTINGS",{languageToggleTip:!1})}});null==(c=document.querySelector(".custom-message-container .language .confirm"))||c.addEventListener("click",(()=>{r(d),a.dispatch("SET_USER_SETTINGS",{language:d}),a.dispatch("SET_GLOBAL_SETTINGS",{language:d}),g.close()}))}}))},m=()=>{n(window.innerWidth),window.addEventListener("resize",((e,t=500)=>{let a,i;return function(...l){i=l,a||(a=setTimeout((()=>{e(...i),a=void 0}),t))}})((e=>{n(e.target.innerWidth)}),600)),Qo(),r(i.language),c(),(async()=>{var e;const{authorized:t,installed:a,token:i,isAutoAuthorize:l}=f((()=>Ca.getters.getGitHubAuthorizationInfo)).value,s=async e=>{Yo.push({path:"/login",query:{jump:"0"}}).then((()=>{e&&e()}))};if(l&&t&&a&&i&&$a()){const t=u.error({customClass:"custom-message-container",duration:0,showClose:!0,message:`<div class="content-box authorization">\n                    <span class="msg">${ot.global.t("authorization.msg_1")}</span>\n                    <spna class="btn-box">\n                      <span class="confirm btn">${ot.global.t("authorization.text_13")}</span>\n                    </spna>\n                  </div>`,dangerouslyUseHTMLString:!0,onClose:()=>{s()}});null==(e=document.querySelector(".custom-message-container .authorization .confirm"))||e.addEventListener("click",(()=>{t.close(),s((()=>{Ca.dispatch("SET_GITHUB_AUTHORIZATION_INFO",{authorizing:!0})}))})),await s()}})()};return S((()=>i.language),(e=>{r(e)})),I((()=>{m()})),(e,t)=>(o(),P(C(De),{size:l.value,"z-index":3e3,locale:s.value},{default:E((()=>[L(vr)])),_:1},8,["size","locale"]))}});const yr=w({__name:"App",setup:e=>(e,t)=>(o(),P(br))});const wr=f((()=>Ca.getters.getUserConfigInfo)).value,{owner:xr,repo:Ir}=wr,Sr=e=>{v.confirm(`\n    <div>${ot.global.t("management_page.delTips")}：</div>\n    <strong>${e.name}</strong>\n    `,ot.global.t("tip"),{dangerouslyUseHTMLString:!0,type:"warning"}).then((async()=>{await(async e=>{e.deleting=!0;const{path:t,sha:a}=e;await Bt(xr,Ir,t,a)?(u.success({message:ot.global.t("management_page.message5")}),await Ca.dispatch("DIR_IMAGE_LIST_REMOVE",e),await Ca.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid)):u.error({message:ot.global.t("management_page.message7")})})(e)})).catch((()=>{}))},kr=async(e,t)=>{const a=ta(e.name),i=rt(),l=`${t}.${a}`;let s;var o;if(s=a.includes("svg")?await(o=oa(e)||"",new Promise((e=>{Mt({baseURL:"",url:o,method:"GET",responseType:"blob"}).then((t=>{if(t){const a=new FileReader;a.onload=()=>{const t=a.result;e(t)},a.onerror=()=>{e(null)},a.readAsDataURL(t)}else e(null)})).catch((()=>{e(null)}))}))):await Yt(oa(e)||"",a),s){const t={uuid:"",base64:{originalBase64:"",watermarkBase64:null,compressBase64:null},fileInfo:{originalFile:null,watermarkFile:null,compressFile:null},filename:{hash:"",suffix:"",name:"",prefix:"",final:"",initName:"",newName:"",isAddHash:!0,isRename:!1,isAddPrefix:!1},beforeUploadStatus:{watermarking:!1,compressing:!1},uploadStatus:{progress:0,uploading:!1},reUploadInfo:{dir:"",path:"",isReUpload:!1}};t.uuid=i,t.base64.originalBase64=s,t.filename.final=l,t.reUploadInfo.isReUpload=!0,t.reUploadInfo.dir=e.dir;let a=l;"/"!==e.dir&&(a=`${e.dir}/${l}`),t.reUploadInfo.path=a;if(await gi(wr,t)){const{path:t,sha:a}=e;return await Bt(xr,Ir,t,a),await Ca.dispatch("UPLOAD_IMG_LIST_REMOVE",e.uuid),await Ca.dispatch("DIR_IMAGE_LIST_REMOVE",e),Promise.resolve(!0)}return Promise.resolve(!1)}return Promise.resolve(!1)},Tr="custom-contextmenu-container";let Lr=null,Er=!1;const Or={mounted(e,t){e.addEventListener("contextmenu",(e=>{e.preventDefault(),e.stopPropagation();const{type:a,dir:i,img:l}=t.value;Ca.commit("SET_UPLOAD_AREA_STATE",{activeInfo:{dir:i,type:a,img:l}});const s=f((()=>Ca.getters.getUserViewDir)).value,o=i?`${"/"===s?"":`${s}/`}${i}`:s;Lr=document.querySelector(`.${Tr}`),Lr||(Lr=document.createElement("ul"),Lr.setAttribute("class",Tr),Lr.style.position="fixed",Lr.style.zIndex="1000",Lr.innerHTML=`<li class="custom-contextmenu-item upload-image">\n                             </li>\n                             <li class="custom-contextmenu-item paste-image">\n                               ${ot.global.t("paste_image")}\n                             </li>\n                             <li class="custom-contextmenu-item copy-link">\n                               ${ot.global.t("copy_link")}\n                             </li>\n                             <li class="custom-contextmenu-item property">\n                               ${ot.global.t("management_page.property")}\n                             </li>\n                             <li class="custom-contextmenu-item rename">\n                               ${ot.global.t("rename")}\n                             </li>\n                             <li class="custom-contextmenu-item remove">\n                               ${ot.global.t("delete")}\n                             </li>\n                             `,document.body.appendChild(Lr));const n=null==Lr?void 0:Lr.querySelector(".upload-image"),r=null==Lr?void 0:Lr.querySelector(".remove"),c=null==Lr?void 0:Lr.querySelector(".rename"),d=null==Lr?void 0:Lr.querySelector(".copy-link"),m=null==Lr?void 0:Lr.querySelector(".property"),g=null==Lr?void 0:Lr.querySelector(".paste-image"),p=()=>{Lr.querySelectorAll(".custom-contextmenu-item").forEach((e=>{e.style.display="none"}))},_=e=>{e.forEach((e=>{e.style.display="flex"}))};a===rl.img&&(p(),_([d,r,c,m])),a===rl.dir&&(p(),_([n]),n.innerHTML=ot.global.t("management_page.contextmenu_2",{dir:o})),a===rl.dirArea&&(p(),_([n]),n.innerHTML=ot.global.t("management_page.contextmenu_1")),a===rl.uploadArea&&(p(),_([g]));let h=e.clientX,b=e.clientY;const y=Lr.clientWidth,w=Lr.clientHeight,x=document.documentElement.clientWidth,I=document.documentElement.clientHeight;y+h>x&&(h=x-y-6),w+b>I&&(b=I-w-6),Lr.style.top=`${b}px`,Lr.style.left=`${h}px`,Er||(Er=!0,null==n||n.addEventListener("click",(async()=>{const e="/"===o?It.rootDir:It.repoDir,t="/"===o?[]:o.split("/");await Ca.dispatch("SET_USER_CONFIG_INFO",{dirMode:e,selectedDir:o,selectedDirList:t}),await Yo.push("/upload")})),null==c||c.addEventListener("click",(async()=>{a===rl.img&&await(async e=>{const t=(e=>{const t=e.lastIndexOf(".");return e.substring(0,t).trim().replace(/\s+/g,"-")})(e.name);await v.prompt(ot.global.t("management_page.text_1"),ot.global.t("tip"),{draggable:!0,inputPattern:/^.+$/,inputErrorMessage:ot.global.t("management_page.message1"),autofocus:!0,inputValue:t,beforeClose:async(a,i,l)=>{if("confirm"===a){if(i.inputValue===t)return void u.warning(ot.global.t("management_page.message2"));i.confirmButtonLoading=!0,i.confirmButtonText=ot.global.t("management_page.loadingTxt2"),await kr(e,i.inputValue)?(i.confirmButtonLoading=!1,u.success(ot.global.t("management_page.message4")),l()):u.error(ot.global.t("management_page.message3"))}else l()}})})(l),rl.dir})),null==r||r.addEventListener("click",(async()=>{a===rl.img&&Sr(l),rl.dir})),null==d||d.addEventListener("click",(async()=>{ca(l)})),null==m||m.addEventListener("click",(async()=>{await(async e=>{await v.confirm(`\n    <div>${ot.global.t("management_page.imageName")}：<strong>${e.name}</strong></div>\n    <div>${ot.global.t("management_page.imageSize")}：<strong>${ia(e.size)} KB</strong></div>\n    `,ot.global.t("management_page.property"),{showCancelButton:!1,showConfirmButton:!1,dangerouslyUseHTMLString:!0,type:"info"})})(l)})),null==g||g.addEventListener("click",(()=>{Ca.commit("SET_UPLOAD_AREA_STATE",{isPaste:!0})})));const S=()=>{Ca.commit("SET_UPLOAD_AREA_STATE",{activeInfo:null}),Lr&&(document.removeEventListener("click",S),document.body.removeChild(Lr),Lr=null,Er=!1)};document.addEventListener("click",S),document.addEventListener("dblclick",S)}))}},Cr=ze(yr);Cr.directive("contextmenu",Or),Cr.use(Yo).use(Ca,Aa).use(ot).mount("#app");export{It as D,Je as I,Ye as P,Ra as _,Ke as a,hi as b,ws as c,Yo as d,ot as e,Ze as f,Nt as g,ga as h,$a as i,pa as j,mt as k,Pl as l,Fi as m,ji as n,Il as o,Mt as r,Ca as s,Pa as u};
